
R version 4.4.1 (2024-06-14 ucrt) -- "Race for Your Life"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "olsrr"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> options(pager = "console")
> library('olsrr')

Attaching package: 'olsrr'

The following object is masked from 'package:datasets':

    rivers

> 
> base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
> base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("ols_aic")
> ### * ols_aic
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_aic
> ### Title: Akaike information criterion
> ### Aliases: ols_aic
> 
> ### ** Examples
> 
> # using R computation method
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_aic(model)
[1] 159.0696
> 
> # using STATA computation method
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_aic(model, method = 'STATA')
[1] 157.0696
> 
> # using SAS computation method
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_aic(model, method = 'SAS')
[1] 66.25754
> 
> # corrected akaike information criterion
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_aic(model, method = 'SAS', corrected = TRUE)
[1] 103.6175
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_apc")
> ### * ols_apc
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_apc
> ### Title: Amemiya's prediction criterion
> ### Aliases: ols_apc
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_apc(model)
[1] 0.2259134
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_coll_diag")
> ### * ols_coll_diag
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_coll_diag
> ### Title: Collinearity diagnostics
> ### Aliases: ols_coll_diag ols_vif_tol ols_eigen_cindex
> 
> ### ** Examples
> 
> # model
> model <- lm(mpg ~ disp + hp + wt + drat, data = mtcars)
> 
> # vif and tolerance
> ols_vif_tol(model)
  Variables Tolerance      VIF
1      disp 0.1218116 8.209402
2        hp 0.3454979 2.894373
3        wt 0.1962092 5.096601
4      drat 0.4386836 2.279547
> 
> # eigenvalues and condition indices
> ols_eigen_cindex(model)
   Eigenvalue Condition Index    intercept        disp          hp           wt
1 4.692806914        1.000000 0.0002323252 0.001106455 0.002566185 0.0007172086
2 0.240308641        4.419078 0.0036813894 0.034132904 0.031334562 0.0009394254
3 0.052153430        9.485821 0.0009192095 0.058394262 0.735003722 0.0700789813
4 0.011406889       20.283026 0.0014476535 0.885725642 0.207337511 0.7179834661
5 0.003324127       37.573144 0.9937194224 0.020640737 0.023758021 0.2102809185
          drat
1 0.0003775503
2 0.0148250672
3 0.0026259361
4 0.0568226912
5 0.9253487552
> 
> # collinearity diagnostics
> ols_coll_diag(model)
Tolerance and Variance Inflation Factor
---------------------------------------
  Variables Tolerance      VIF
1      disp 0.1218116 8.209402
2        hp 0.3454979 2.894373
3        wt 0.1962092 5.096601
4      drat 0.4386836 2.279547


Eigenvalue and Condition Index
------------------------------
   Eigenvalue Condition Index    intercept        disp          hp           wt
1 4.692806914        1.000000 0.0002323252 0.001106455 0.002566185 0.0007172086
2 0.240308641        4.419078 0.0036813894 0.034132904 0.031334562 0.0009394254
3 0.052153430        9.485821 0.0009192095 0.058394262 0.735003722 0.0700789813
4 0.011406889       20.283026 0.0014476535 0.885725642 0.207337511 0.7179834661
5 0.003324127       37.573144 0.9937194224 0.020640737 0.023758021 0.2102809185
          drat
1 0.0003775503
2 0.0148250672
3 0.0026259361
4 0.0568226912
5 0.9253487552
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_correlations")
> ### * ols_correlations
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_correlations
> ### Title: Part and partial correlations
> ### Aliases: ols_correlations
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_correlations(model)
               Correlations                 
-------------------------------------------
Variable    Zero Order    Partial     Part  
-------------------------------------------
disp            -0.848      0.048     0.019 
hp              -0.776     -0.224    -0.093 
wt              -0.868     -0.574    -0.285 
qsec             0.419      0.219     0.091 
-------------------------------------------
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_fpe")
> ### * ols_fpe
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_fpe
> ### Title: Final prediction error
> ### Aliases: ols_fpe
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_fpe(model)
[1] 7.949661
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_hadi")
> ### * ols_hadi
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_hadi
> ### Title: Hadi's influence measure
> ### Aliases: ols_hadi
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_hadi(model)
$hadi
          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
         0.19318654          0.10375645          0.20740884          0.09775893 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
         0.20724815          0.19946745          0.19652103          0.19692137 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
         0.12314263          0.14455206          0.24742810          0.10784806 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
         0.05027013          0.11471138          0.25914561          0.29265274 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
         1.14426624          0.99609055          0.20171955          1.06239341 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
         0.28064340          0.35373215          0.44820010          0.15099700 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
         0.41281074          0.10477548          0.08003177          0.37633639 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
         0.32631790          0.19910073          1.19634000          0.14496664 

$potential
 [1] 0.04642961 0.04793496 0.06734998 0.09700248 0.20204116 0.07204021
 [7] 0.15814866 0.14431329 0.10998283 0.12811895 0.12811895 0.09886225
[13] 0.04904646 0.05345386 0.25898633 0.26443008 0.23883499 0.09118421
[19] 0.17116856 0.11159933 0.06050321 0.10075604 0.08338035 0.11503917
[25] 0.24318619 0.10245226 0.08001939 0.19678226 0.31299327 0.15926270
[31] 0.99626944 0.08504229

$residual
          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
       0.1467569282        0.0558214978        0.1400588567        0.0007564513 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
       0.0052069911        0.1274272438        0.0383723684        0.0526080784 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
       0.0131598054        0.0164331043        0.1193091514        0.0089858122 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
       0.0012236671        0.0612575182        0.0001592827        0.0282226574 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
       0.9054312452        0.9049063421        0.0305509895        0.9507940779 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
       0.2201401850        0.2529761045        0.3648197429        0.0359578331 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
       0.1696245441        0.0023232180        0.0000123722        0.1795541315 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
       0.0133246374        0.0398380292        0.2000705631        0.0599243499 

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_hsp")
> ### * ols_hsp
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_hsp
> ### Title: Hocking's Sp
> ### Aliases: ols_hsp
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_hsp(model)
[1] 0.2644378
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_launch_app")
> ### * ols_launch_app
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_launch_app
> ### Title: Launch shiny app
> ### Aliases: ols_launch_app
> 
> ### ** Examples
> 
> ## Not run: 
> ##D ols_launch_app()
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("ols_leverage")
> ### * ols_leverage
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_leverage
> ### Title: Leverage
> ### Aliases: ols_leverage
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_leverage(model)
 [1] 0.14830256 0.12992351 0.06317600 0.11598460 0.17187869 0.09986745
 [7] 0.14720085 0.12912656 0.45839085 0.13597113 0.11541159 0.10343044
[13] 0.04684167 0.05527722 0.20578392 0.21066328 0.19546860 0.08593044
[19] 0.14685385 0.14389010 0.11957800 0.11051613 0.08002229 0.10635592
[25] 0.19566514 0.09324142 0.15093650 0.16467565 0.23978580 0.21863752
[31] 0.53168134 0.07953098
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_mallows_cp")
> ### * ols_mallows_cp
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_mallows_cp
> ### Title: Mallow's Cp
> ### Aliases: ols_mallows_cp
> 
> ### ** Examples
> 
> full_model <- lm(mpg ~ ., data = mtcars)
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_mallows_cp(model, full_model)
[1] 4.430434
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_msep")
> ### * ols_msep
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_msep
> ### Title: MSEP
> ### Aliases: ols_msep
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_msep(model)
[1] 220.8882
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_added_variable")
> ### * ols_plot_added_variable
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_added_variable
> ### Title: Added variable plots
> ### Aliases: ols_plot_added_variable
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_added_variable(model)
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_comp_plus_resid")
> ### * ols_plot_comp_plus_resid
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_comp_plus_resid
> ### Title: Residual plus component plot
> ### Aliases: ols_plot_comp_plus_resid
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_plot_comp_plus_resid(model)
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_cooksd_bar")
> ### * ols_plot_cooksd_bar
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_cooksd_bar
> ### Title: Cooks' D bar plot
> ### Aliases: ols_plot_cooksd_bar
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_cooksd_bar(model)
> ols_plot_cooksd_bar(model, type = 4)
> ols_plot_cooksd_bar(model, threshold = 0.2)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_cooksd_chart")
> ### * ols_plot_cooksd_chart
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_cooksd_chart
> ### Title: Cooks' D chart
> ### Aliases: ols_plot_cooksd_chart
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_cooksd_chart(model)
> ols_plot_cooksd_chart(model, type = 4)
> ols_plot_cooksd_chart(model, threshold = 0.2)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_dfbetas")
> ### * ols_plot_dfbetas
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_dfbetas
> ### Title: DFBETAs panel
> ### Aliases: ols_plot_dfbetas
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_plot_dfbetas(model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_dffits")
> ### * ols_plot_dffits
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_dffits
> ### Title: DFFITS plot
> ### Aliases: ols_plot_dffits
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_plot_dffits(model)
> ols_plot_dffits(model, size_adj_threshold = FALSE)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_diagnostics")
> ### * ols_plot_diagnostics
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_diagnostics
> ### Title: Diagnostics panel
> ### Aliases: ols_plot_diagnostics
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_plot_diagnostics(model)
Warning in geom_segment(data = d, aes(x = min(x), y = min(y), xend = max(x),  :
  All aesthetics have length 1, but the data has 32 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.
Warning in geom_segment(data = d, aes(x = min(x), y = min(y), xend = max(x),  :
  All aesthetics have length 1, but the data has 32 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_hadi")
> ### * ols_plot_hadi
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_hadi
> ### Title: Hadi plot
> ### Aliases: ols_plot_hadi
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_hadi(model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_obs_fit")
> ### * ols_plot_obs_fit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_obs_fit
> ### Title: Observed vs fitted values plot
> ### Aliases: ols_plot_obs_fit
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_obs_fit(model)
Warning in geom_segment(data = d, aes(x = min(x), y = min(y), xend = max(x),  :
  All aesthetics have length 1, but the data has 32 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_reg_line")
> ### * ols_plot_reg_line
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_reg_line
> ### Title: Simple linear regression line
> ### Aliases: ols_plot_reg_line
> 
> ### ** Examples
> 
> ols_plot_reg_line(mtcars$mpg, mtcars$disp)
`geom_smooth()` using formula = 'y ~ x'
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_box")
> ### * ols_plot_resid_box
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_box
> ### Title: Residual box plot
> ### Aliases: ols_plot_resid_box
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_resid_box(model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_fit")
> ### * ols_plot_resid_fit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_fit
> ### Title: Residual vs fitted plot
> ### Aliases: ols_plot_resid_fit
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_resid_fit(model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_fit_spread")
> ### * ols_plot_resid_fit_spread
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_fit_spread
> ### Title: Residual fit spread plot
> ### Aliases: ols_plot_resid_fit_spread ols_plot_fm ols_plot_resid_spread
> 
> ### ** Examples
> 
> # model
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> 
> # residual fit spread plot
> ols_plot_resid_fit_spread(model)
> 
> # fit mean plot
> ols_plot_fm(model)
> 
> # residual spread plot
> ols_plot_resid_spread(model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_hist")
> ### * ols_plot_resid_hist
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_hist
> ### Title: Residual histogram
> ### Aliases: ols_plot_resid_hist
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_resid_hist(model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_lev")
> ### * ols_plot_resid_lev
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_lev
> ### Title: Studentized residuals vs leverage plot
> ### Aliases: ols_plot_resid_lev
> 
> ### ** Examples
> 
> model <- lm(read ~ write + math + science, data = hsb)
> ols_plot_resid_lev(model)
> ols_plot_resid_lev(model, threshold = 3)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_pot")
> ### * ols_plot_resid_pot
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_pot
> ### Title: Potential residual plot
> ### Aliases: ols_plot_resid_pot
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_resid_pot(model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_qq")
> ### * ols_plot_resid_qq
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_qq
> ### Title: Residual QQ plot
> ### Aliases: ols_plot_resid_qq
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_resid_qq(model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_regressor")
> ### * ols_plot_resid_regressor
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_regressor
> ### Title: Residual vs regressor plot
> ### Aliases: ols_plot_resid_regressor
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_resid_regressor(model, 'drat')
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_stand")
> ### * ols_plot_resid_stand
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_stand
> ### Title: Standardized residual chart
> ### Aliases: ols_plot_resid_stand
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_resid_stand(model)
> ols_plot_resid_stand(model, threshold = 3)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_stud")
> ### * ols_plot_resid_stud
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_stud
> ### Title: Studentized residual plot
> ### Aliases: ols_plot_resid_stud
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_resid_stud(model)
> ols_plot_resid_stud(model, threshold = 2)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_resid_stud_fit")
> ### * ols_plot_resid_stud_fit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_resid_stud_fit
> ### Title: Deleted studentized residual vs fitted values plot
> ### Aliases: ols_plot_resid_stud_fit
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_plot_resid_stud_fit(model)
> ols_plot_resid_stud_fit(model, threshold = 3)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_plot_response")
> ### * ols_plot_response
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_plot_response
> ### Title: Response variable profile
> ### Aliases: ols_plot_response
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_plot_response(model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_pred_rsq")
> ### * ols_pred_rsq
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_pred_rsq
> ### Title: Predicted rsquare
> ### Aliases: ols_pred_rsq
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_pred_rsq(model)
[1] 0.7710297
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_avplot_data")
> ### * ols_prep_avplot_data
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_avplot_data
> ### Title: Added variable plot data
> ### Aliases: ols_prep_avplot_data
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_prep_avplot_data(model)
                     mpg  disp  hp    wt
Mazda RX4           21.0 160.0 110 2.620
Mazda RX4 Wag       21.0 160.0 110 2.875
Datsun 710          22.8 108.0  93 2.320
Hornet 4 Drive      21.4 258.0 110 3.215
Hornet Sportabout   18.7 360.0 175 3.440
Valiant             18.1 225.0 105 3.460
Duster 360          14.3 360.0 245 3.570
Merc 240D           24.4 146.7  62 3.190
Merc 230            22.8 140.8  95 3.150
Merc 280            19.2 167.6 123 3.440
Merc 280C           17.8 167.6 123 3.440
Merc 450SE          16.4 275.8 180 4.070
Merc 450SL          17.3 275.8 180 3.730
Merc 450SLC         15.2 275.8 180 3.780
Cadillac Fleetwood  10.4 472.0 205 5.250
Lincoln Continental 10.4 460.0 215 5.424
Chrysler Imperial   14.7 440.0 230 5.345
Fiat 128            32.4  78.7  66 2.200
Honda Civic         30.4  75.7  52 1.615
Toyota Corolla      33.9  71.1  65 1.835
Toyota Corona       21.5 120.1  97 2.465
Dodge Challenger    15.5 318.0 150 3.520
AMC Javelin         15.2 304.0 150 3.435
Camaro Z28          13.3 350.0 245 3.840
Pontiac Firebird    19.2 400.0 175 3.845
Fiat X1-9           27.3  79.0  66 1.935
Porsche 914-2       26.0 120.3  91 2.140
Lotus Europa        30.4  95.1 113 1.513
Ford Pantera L      15.8 351.0 264 3.170
Ferrari Dino        19.7 145.0 175 2.770
Maserati Bora       15.0 301.0 335 3.570
Volvo 142E          21.4 121.0 109 2.780
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_cdplot_data")
> ### * ols_prep_cdplot_data
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_cdplot_data
> ### Title: Cooks' D plot data
> ### Aliases: ols_prep_cdplot_data
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ols_prep_cdplot_data(model)
$ckd
                    obs           cd   color fct_color
Mazda RX4             1 1.152035e-02  normal    normal
Mazda RX4 Wag         2 4.621112e-03  normal    normal
Datsun 710            3 1.598334e-02  normal    normal
Hornet 4 Drive        4 1.283888e-04  normal    normal
Hornet Sportabout     5 1.839055e-03  normal    normal
Valiant               6 1.560119e-02  normal    normal
Duster 360            7 1.053270e-02  normal    normal
Merc 240D             8 1.313511e-02  normal    normal
Merc 230              9 2.525382e-03  normal    normal
Merc 280             10 3.671067e-03  normal    normal
Merc 280C            11 2.606104e-02  normal    normal
Merc 450SE           12 1.551454e-03  normal    normal
Merc 450SL           13 1.049983e-04  normal    normal
Merc 450SLC          14 5.648180e-03  normal    normal
Cadillac Fleetwood   15 7.218880e-05  normal    normal
Lincoln Continental  16 1.298764e-02  normal    normal
Chrysler Imperial    17 3.199707e-01 outlier   outlier
Fiat 128             18 1.196019e-01  normal    normal
Honda Civic          19 9.092102e-03  normal    normal
Toyota Corolla       20 1.529771e-01 outlier   outlier
Toyota Corona        21 2.215865e-02  normal    normal
Dodge Challenger     22 4.218196e-02  normal    normal
AMC Javelin          23 4.909944e-02  normal    normal
Camaro Z28           24 7.181085e-03  normal    normal
Pontiac Firebird     25 6.980693e-02  normal    normal
Fiat X1-9            26 4.163138e-04  normal    normal
Porsche 914-2        27 1.732523e-06  normal    normal
Lotus Europa         28 5.959750e-02  normal    normal
Ford Pantera L       29 7.279943e-03  normal    normal
Ferrari Dino         30 1.100867e-02  normal    normal
Maserati Bora        31 3.402911e-01 outlier   outlier
Volvo 142E           32 8.796726e-03  normal    normal

$maxx
[1] 0.3436941

$ts
[1] 0.125

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_cdplot_outliers")
> ### * ols_prep_cdplot_outliers
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_cdplot_outliers
> ### Title: Cooks' d outlier data
> ### Aliases: ols_prep_cdplot_outliers
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> k <- ols_prep_cdplot_data(model)
> ols_prep_cdplot_outliers(k)
                  observation cooks_distance
Chrysler Imperial          17      0.3199707
Toyota Corolla             20      0.1529771
Maserati Bora              31      0.3402911
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_dfbeta_data")
> ### * ols_prep_dfbeta_data
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_dfbeta_data
> ### Title: DFBETAs plot data
> ### Aliases: ols_prep_dfbeta_data
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> dfb <- dfbetas(model)
> n <- nrow(dfb)
> threshold <- 2 / sqrt(n)
> dbetas  <- dfb[, 1]
> df_data <- data.frame(obs = seq_len(n), dbetas = dbetas)
> ols_prep_dfbeta_data(df_data, threshold)
                    obs        dbetas   color fct_color txt
Mazda RX4             1 -0.2408625040  normal    normal  NA
Mazda RX4 Wag         2 -0.0893854682  normal    normal  NA
Datsun 710            3 -0.0226714112  normal    normal  NA
Hornet 4 Drive        4  0.0165461439  normal    normal  NA
Hornet Sportabout     5 -0.0001791988  normal    normal  NA
Valiant               6  0.2161392861  normal    normal  NA
Duster 360            7  0.0559934442  normal    normal  NA
Merc 240D             8  0.0339246041  normal    normal  NA
Merc 230              9  0.4484991305 outlier   outlier   9
Merc 280             10 -0.0178054777  normal    normal  NA
Merc 280C            11 -0.0032897727  normal    normal  NA
Merc 450SE           12  0.0270335275  normal    normal  NA
Merc 450SL           13 -0.0022994410  normal    normal  NA
Merc 450SLC          14  0.0663413205  normal    normal  NA
Cadillac Fleetwood   15 -0.0010867064  normal    normal  NA
Lincoln Continental  16 -0.0129594354  normal    normal  NA
Chrysler Imperial    17 -0.0672243472  normal    normal  NA
Fiat 128             18 -0.0353581676  normal    normal  NA
Honda Civic          19  0.0591178524  normal    normal  NA
Toyota Corolla       20 -0.3583658816 outlier   outlier  20
Toyota Corona        21  0.3763120390 outlier   outlier  21
Dodge Challenger     22 -0.2073631012  normal    normal  NA
AMC Javelin          23 -0.1393390661  normal    normal  NA
Camaro Z28           24 -0.0209471589  normal    normal  NA
Pontiac Firebird     25  0.0503356537  normal    normal  NA
Fiat X1-9            26 -0.0059464066  normal    normal  NA
Porsche 914-2        27  0.1174959855  normal    normal  NA
Lotus Europa         28  0.1206617098  normal    normal  NA
Ford Pantera L       29 -0.0016098012  normal    normal  NA
Ferrari Dino         30 -0.0519535108  normal    normal  NA
Maserati Bora        31 -0.2994696671  normal    normal  NA
Volvo 142E           32 -0.0168421538  normal    normal  NA
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_dfbeta_outliers")
> ### * ols_prep_dfbeta_outliers
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_dfbeta_outliers
> ### Title: DFBETAs plot outliers
> ### Aliases: ols_prep_dfbeta_outliers
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> dfb <- dfbetas(model)
> n <- nrow(dfb)
> threshold <- 2 / sqrt(n)
> dbetas  <- dfb[, 1]
> df_data <- data.frame(obs = seq_len(n), dbetas = dbetas)
> d <- ols_prep_dfbeta_data(df_data, threshold)
> ols_prep_dfbeta_outliers(d)
               obs     dbetas
Merc 230         9  0.4484991
Toyota Corolla  20 -0.3583659
Toyota Corona   21  0.3763120
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_dsrvf_data")
> ### * ols_prep_dsrvf_data
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_dsrvf_data
> ### Title: Deleted studentized residual plot data
> ### Aliases: ols_prep_dsrvf_data
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_prep_dsrvf_data(model)
$ds
                    obs      pred         dsr   color fct_color
Mazda RX4             1 22.583962 -0.64748839  normal    normal
Mazda RX4 Wag         2 21.713366 -0.28666527  normal    normal
Datsun 710            3 25.315315 -0.99075628  normal    normal
Hornet 4 Drive        4 21.724442 -0.12918232  normal    normal
Hornet Sportabout     5 18.429194  0.11139625  normal    normal
Valiant               6 21.024991 -1.18451521  normal    normal
Duster 360            7 15.881265 -0.64594383  normal    normal
Merc 240D             8 22.743604  0.66997702  normal    normal
Merc 230              9 23.874317 -0.54948140  normal    normal
Merc 280             10 19.583341 -0.15441033  normal    normal
Merc 280C            11 19.909837 -0.85114256  normal    normal
Merc 450SE           12 15.414384  0.39070003  normal    normal
Merc 450SL           13 17.090317  0.08038783  normal    normal
Merc 450SLC          14 17.077525 -0.73029648  normal    normal
Cadillac Fleetwood   15 10.347731  0.02195020  normal    normal
Lincoln Continental  16  9.240018  0.49088476  normal    normal
Chrysler Imperial    17  9.053153  2.65670246 outlier   outlier
Fiat 128             18 26.762248  2.44800052 outlier   outlier
Honda Civic          19 29.194960  0.49050814  normal    normal
Toyota Corolla       20 28.676968  2.32117834 outlier   outlier
Toyota Corona        21 25.366415 -1.61789048  normal    normal
Dodge Challenger     22 18.333506 -1.15275035  normal    normal
AMC Javelin          23 18.921940 -1.51497848  normal    normal
Camaro Z28           24 14.376149 -0.42753101  normal    normal
Pontiac Firebird     25 16.685482  1.07223104  normal    normal
Fiat X1-9            26 27.674294 -0.14716500  normal    normal
Porsche 914-2        27 25.175740  0.33549692  normal    normal
Lotus Europa         28 27.696641  1.13400631  normal    normal
Ford Pantera L       29 16.617084 -0.35154799  normal    normal
Ferrari Dino         30 20.116900 -0.17661296  normal    normal
Maserati Bora        31 13.369229  0.90578477  normal    normal
Volvo 142E           32 22.925681 -0.59923054  normal    normal

$cminx
[1] -2.61789

$cmaxx
[1] 3.656702

> ols_prep_dsrvf_data(model, threshold = 3)
$ds
                    obs      pred         dsr  color fct_color
Mazda RX4             1 22.583962 -0.64748839 normal    normal
Mazda RX4 Wag         2 21.713366 -0.28666527 normal    normal
Datsun 710            3 25.315315 -0.99075628 normal    normal
Hornet 4 Drive        4 21.724442 -0.12918232 normal    normal
Hornet Sportabout     5 18.429194  0.11139625 normal    normal
Valiant               6 21.024991 -1.18451521 normal    normal
Duster 360            7 15.881265 -0.64594383 normal    normal
Merc 240D             8 22.743604  0.66997702 normal    normal
Merc 230              9 23.874317 -0.54948140 normal    normal
Merc 280             10 19.583341 -0.15441033 normal    normal
Merc 280C            11 19.909837 -0.85114256 normal    normal
Merc 450SE           12 15.414384  0.39070003 normal    normal
Merc 450SL           13 17.090317  0.08038783 normal    normal
Merc 450SLC          14 17.077525 -0.73029648 normal    normal
Cadillac Fleetwood   15 10.347731  0.02195020 normal    normal
Lincoln Continental  16  9.240018  0.49088476 normal    normal
Chrysler Imperial    17  9.053153  2.65670246 normal    normal
Fiat 128             18 26.762248  2.44800052 normal    normal
Honda Civic          19 29.194960  0.49050814 normal    normal
Toyota Corolla       20 28.676968  2.32117834 normal    normal
Toyota Corona        21 25.366415 -1.61789048 normal    normal
Dodge Challenger     22 18.333506 -1.15275035 normal    normal
AMC Javelin          23 18.921940 -1.51497848 normal    normal
Camaro Z28           24 14.376149 -0.42753101 normal    normal
Pontiac Firebird     25 16.685482  1.07223104 normal    normal
Fiat X1-9            26 27.674294 -0.14716500 normal    normal
Porsche 914-2        27 25.175740  0.33549692 normal    normal
Lotus Europa         28 27.696641  1.13400631 normal    normal
Ford Pantera L       29 16.617084 -0.35154799 normal    normal
Ferrari Dino         30 20.116900 -0.17661296 normal    normal
Maserati Bora        31 13.369229  0.90578477 normal    normal
Volvo 142E           32 22.925681 -0.59923054 normal    normal

$cminx
[1] -3.5

$cmaxx
[1] 3.656702

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_outlier_obs")
> ### * ols_prep_outlier_obs
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_outlier_obs
> ### Title: Cooks' D outlier observations
> ### Aliases: ols_prep_outlier_obs
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> k <- ols_prep_cdplot_data(model)
> ols_prep_outlier_obs(k)
                    obs           cd   color fct_color txt
Mazda RX4             1 1.152035e-02  normal    normal  NA
Mazda RX4 Wag         2 4.621112e-03  normal    normal  NA
Datsun 710            3 1.598334e-02  normal    normal  NA
Hornet 4 Drive        4 1.283888e-04  normal    normal  NA
Hornet Sportabout     5 1.839055e-03  normal    normal  NA
Valiant               6 1.560119e-02  normal    normal  NA
Duster 360            7 1.053270e-02  normal    normal  NA
Merc 240D             8 1.313511e-02  normal    normal  NA
Merc 230              9 2.525382e-03  normal    normal  NA
Merc 280             10 3.671067e-03  normal    normal  NA
Merc 280C            11 2.606104e-02  normal    normal  NA
Merc 450SE           12 1.551454e-03  normal    normal  NA
Merc 450SL           13 1.049983e-04  normal    normal  NA
Merc 450SLC          14 5.648180e-03  normal    normal  NA
Cadillac Fleetwood   15 7.218880e-05  normal    normal  NA
Lincoln Continental  16 1.298764e-02  normal    normal  NA
Chrysler Imperial    17 3.199707e-01 outlier   outlier  17
Fiat 128             18 1.196019e-01  normal    normal  NA
Honda Civic          19 9.092102e-03  normal    normal  NA
Toyota Corolla       20 1.529771e-01 outlier   outlier  20
Toyota Corona        21 2.215865e-02  normal    normal  NA
Dodge Challenger     22 4.218196e-02  normal    normal  NA
AMC Javelin          23 4.909944e-02  normal    normal  NA
Camaro Z28           24 7.181085e-03  normal    normal  NA
Pontiac Firebird     25 6.980693e-02  normal    normal  NA
Fiat X1-9            26 4.163138e-04  normal    normal  NA
Porsche 914-2        27 1.732523e-06  normal    normal  NA
Lotus Europa         28 5.959750e-02  normal    normal  NA
Ford Pantera L       29 7.279943e-03  normal    normal  NA
Ferrari Dino         30 1.100867e-02  normal    normal  NA
Maserati Bora        31 3.402911e-01 outlier   outlier  31
Volvo 142E           32 8.796726e-03  normal    normal  NA
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_regress_x")
> ### * ols_prep_regress_x
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_regress_x
> ### Title: Regress predictor on other predictors
> ### Aliases: ols_prep_regress_x
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> data <- ols_prep_avplot_data(model)
> ols_prep_regress_x(data, 1)
 [1] -2.5700299 -1.6008028 -2.4886829  0.1833269  0.4592780 -2.3721590
 [7] -1.2656477  1.4885011  0.7591033 -0.8411432 -2.2411432  0.6307257
[13]  0.2384229 -1.6715326  0.0785315  1.0402079  5.4885456  5.7865290
[19]  1.1240053  5.8609261 -3.1015898 -3.2549189 -3.8911127 -1.2487773
[25]  2.5361190 -0.3204259 -0.0236311  2.6550420 -0.7024625 -1.2887756
[31]  2.1831584 -1.6295873
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_regress_y")
> ### * ols_prep_regress_y
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_regress_y
> ### Title: Regress y on other predictors
> ### Aliases: ols_prep_regress_y
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> data <- ols_prep_avplot_data(model)
> ols_prep_regress_y(data, 1)
 [1] -2.5700299 -1.6008028 -2.4886829  0.1833269  0.4592780 -2.3721590
 [7] -1.2656477  1.4885011  0.7591033 -0.8411432 -2.2411432  0.6307257
[13]  0.2384229 -1.6715326  0.0785315  1.0402079  5.4885456  5.7865290
[19]  1.1240053  5.8609261 -3.1015898 -3.2549189 -3.8911127 -1.2487773
[25]  2.5361190 -0.3204259 -0.0236311  2.6550420 -0.7024625 -1.2887756
[31]  2.1831584 -1.6295873
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_rfsplot_fmdata")
> ### * ols_prep_rfsplot_fmdata
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_rfsplot_fmdata
> ### Title: Residual fit spread plot data
> ### Aliases: ols_prep_rfsplot_fmdata ols_prep_rfsplot_rsdata
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_prep_rfsplot_fmdata(model)
                          x            y
Mazda RX4           0.65625   2.49333715
Mazda RX4 Wag       0.59375   1.62274065
Datsun 710          0.81250   5.22468963
Hornet 4 Drive      0.62500   1.63381717
Hornet Sportabout   0.40625  -1.66143057
Valiant             0.56250   0.93436596
Duster 360          0.21875  -4.20935985
Merc 240D           0.68750   2.65297895
Merc 230            0.75000   3.78369213
Merc 280            0.46875  -0.50728418
Merc 280C           0.50000  -0.18078799
Merc 450SE          0.18750  -4.67624141
Merc 450SL          0.34375  -3.00030766
Merc 450SLC         0.31250  -3.01309966
Cadillac Fleetwood  0.09375  -9.74289440
Lincoln Continental 0.06250 -10.85060658
Chrysler Imperial   0.03125 -11.03747168
Fiat 128            0.87500   6.67162325
Honda Civic         1.00000   9.10433522
Toyota Corolla      0.96875   8.58634326
Toyota Corona       0.84375   5.27579029
Dodge Challenger    0.37500  -1.75711947
AMC Javelin         0.43750  -1.16868515
Camaro Z28          0.15625  -5.71447620
Pontiac Firebird    0.28125  -3.40514317
Fiat X1-9           0.90625   7.58366929
Porsche 914-2       0.78125   5.08511501
Lotus Europa        0.93750   7.60601644
Ford Pantera L      0.25000  -3.47354135
Ferrari Dino        0.53125   0.02627523
Maserati Bora       0.12500  -6.72139630
Volvo 142E          0.71875   2.83505599
> ols_prep_rfsplot_rsdata(model)
                          x          y
Mazda RX4           0.25000 -1.5839621
Mazda RX4 Wag       0.43750 -0.7133657
Datsun 710          0.15625 -2.5153146
Hornet 4 Drive      0.56250 -0.3244422
Hornet Sportabout   0.65625  0.2708056
Valiant             0.09375 -2.9249910
Duster 360          0.28125 -1.5812652
Merc 240D           0.84375  1.6563961
Merc 230            0.37500 -1.0743171
Merc 280            0.50000 -0.3833408
Merc 280C           0.18750 -2.1098370
Merc 450SE          0.71875  0.9856164
Merc 450SL          0.62500  0.2096827
Merc 450SLC         0.21875 -1.8775253
Cadillac Fleetwood  0.59375  0.0522694
Lincoln Continental 0.75000  1.1599816
Chrysler Imperial   1.00000  5.6468467
Fiat 128            0.96875  5.6377518
Honda Civic         0.78125  1.2050398
Toyota Corolla      0.93750  5.2230317
Toyota Corona       0.03125 -3.8664153
Dodge Challenger    0.12500 -2.8335055
AMC Javelin         0.06250 -3.7219399
Camaro Z28          0.34375 -1.0761488
Pontiac Firebird    0.87500  2.5145182
Fiat X1-9           0.53125 -0.3742943
Porsche 914-2       0.68750  0.8242600
Lotus Europa        0.90625  2.7033586
Ford Pantera L      0.40625 -0.8170837
Ferrari Dino        0.46875 -0.4169002
Maserati Bora       0.81250  1.6307713
Volvo 142E          0.31250 -1.5256810
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_rstudlev_data")
> ### * ols_prep_rstudlev_data
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_rstudlev_data
> ### Title: Studentized residual vs leverage plot data
> ### Aliases: ols_prep_rstudlev_data
> 
> ### ** Examples
> 
> model <- lm(read ~ write + math + science, data = hsb)
> ols_prep_rstudlev_data(model)
$levrstud
    obs    leverage      rstudent              color          fct_color
1     1 0.016663013  1.5615178576             normal             normal
2     2 0.015958467  1.5674686935             normal             normal
3     3 0.055990789 -0.8622668267           leverage           leverage
4     4 0.013278027  2.1255029597            outlier            outlier
5     5 0.007234223 -1.0086194988             normal             normal
6     6 0.018982871 -1.5536180050             normal             normal
7     7 0.028207407 -0.0033083160             normal             normal
8     8 0.013469959 -1.4291604750             normal             normal
9     9 0.007794713  1.0654028866             normal             normal
10   10 0.006109328  0.7204677404             normal             normal
11   11 0.009636149  1.3900119349             normal             normal
12   12 0.027302624 -0.1190230101             normal             normal
13   13 0.026214458  1.3622240361             normal             normal
14   14 0.011567201 -0.4650712801             normal             normal
15   15 0.049225149 -0.1522931868           leverage           leverage
16   16 0.012197431 -0.7369695795             normal             normal
17   17 0.005225105 -0.5538375471             normal             normal
18   18 0.008282313 -0.1206769984             normal             normal
19   19 0.016057765  1.2094871126             normal             normal
20   20 0.031691152  0.5875672266             normal             normal
21   21 0.079987477  2.1249199600 outlier & leverage outlier & leverage
22   22 0.038690269 -0.8885924544             normal             normal
23   23 0.024796396  0.3989106927             normal             normal
24   24 0.012184872  0.5148854800             normal             normal
25   25 0.013774377 -0.9253782818             normal             normal
26   26 0.021954211 -1.1784121774             normal             normal
27   27 0.016656157  0.3009278833             normal             normal
28   28 0.007015637 -1.3949833362             normal             normal
29   29 0.023947729  0.0687139016             normal             normal
30   30 0.014919053  0.3301869369             normal             normal
31   31 0.060332209 -0.7746718907           leverage           leverage
32   32 0.022532977  2.3453042406            outlier            outlier
33   33 0.018797715  0.1825653880             normal             normal
34   34 0.068933532 -2.2528504213 outlier & leverage outlier & leverage
35   35 0.017763012 -0.4927644910             normal             normal
36   36 0.014536648  0.0173928975             normal             normal
37   37 0.049206361  0.4119453403           leverage           leverage
38   38 0.020025025  0.0813920657             normal             normal
39   39 0.035928203  1.1535955907             normal             normal
40   40 0.031561577  0.0790182178             normal             normal
41   41 0.013572369  0.4986514768             normal             normal
42   42 0.010027638 -0.5841201617             normal             normal
43   43 0.006334353 -0.4439399459             normal             normal
44   44 0.017061392 -0.4647805161             normal             normal
45   45 0.035564567  1.2103260683             normal             normal
46   46 0.021088934 -1.1152833455             normal             normal
47   47 0.022605754  0.9846953174             normal             normal
48   48 0.024263530  0.2037596196             normal             normal
49   49 0.014153579 -1.5841455905             normal             normal
50   50 0.014341980  0.5046561856             normal             normal
51   51 0.009980292 -0.8428749146             normal             normal
52   52 0.033699644 -0.2244305253             normal             normal
53   53 0.027622072 -1.2704393116             normal             normal
54   54 0.013124733  1.4031499379             normal             normal
55   55 0.031840490  0.8388462618             normal             normal
56   56 0.044295731  0.1444303526           leverage           leverage
57   57 0.026517891 -0.2679828969             normal             normal
58   58 0.038734380 -0.4398184906             normal             normal
59   59 0.007307716  1.0105795250             normal             normal
60   60 0.009862399 -0.1085065460             normal             normal
61   61 0.021828959  0.0643870692             normal             normal
62   62 0.020458503 -2.2867946914            outlier            outlier
63   63 0.022694326  0.6230980698             normal             normal
64   64 0.028589146 -0.6392045195             normal             normal
65   65 0.024840216  0.8728884281             normal             normal
66   66 0.021137375 -0.0139993151             normal             normal
67   67 0.009172486  0.5386382740             normal             normal
68   68 0.017134182  0.4464274622             normal             normal
69   69 0.040440609  0.9891610642           leverage           leverage
70   70 0.033437870  0.8974746735             normal             normal
71   71 0.014044304  0.0266382273             normal             normal
72   72 0.008020965  0.5191148106             normal             normal
73   73 0.025324219  1.0321756789             normal             normal
74   74 0.036634172  0.8269809015             normal             normal
75   75 0.021462694  0.7654046005             normal             normal
76   76 0.014695884  0.5012495411             normal             normal
77   77 0.013395096  0.1647799838             normal             normal
78   78 0.012650645  1.3992743502             normal             normal
79   79 0.023877061 -1.5838362422             normal             normal
80   80 0.023944531 -0.0027914606             normal             normal
81   81 0.007259335  0.9613788128             normal             normal
82   82 0.015743305 -2.7157286565            outlier            outlier
83   83 0.027927049  0.4544767500             normal             normal
84   84 0.035564567  0.9176207661             normal             normal
85   85 0.015802654  1.8373806393             normal             normal
86   86 0.013593984 -1.0111400482             normal             normal
87   87 0.018450590  0.4099709140             normal             normal
88   88 0.018152864 -1.3353363732             normal             normal
89   89 0.034064291  1.9065087673             normal             normal
90   90 0.020048187 -0.3183460774             normal             normal
91   91 0.033632340 -0.8765367429             normal             normal
92   92 0.033055971  1.2869743107             normal             normal
93   93 0.020615606  0.5489294217             normal             normal
94   94 0.013566003 -1.2341012351             normal             normal
95   95 0.009552626 -0.3135792639             normal             normal
96   96 0.012218735 -1.5716965630             normal             normal
97   97 0.026586251  0.6272069017             normal             normal
98   98 0.026388503 -0.6031937785             normal             normal
99   99 0.015834328 -1.0867225368             normal             normal
100 100 0.020602109 -0.0814710621             normal             normal
101 101 0.020879765  0.6722859307             normal             normal
102 102 0.017775829 -1.7650237091             normal             normal
103 103 0.028718728  0.4855645788             normal             normal
104 104 0.005818563  1.5805326069             normal             normal
105 105 0.012942231 -0.6547693963             normal             normal
106 106 0.045440580  0.0510560203           leverage           leverage
107 107 0.029142127  0.1004793698             normal             normal
108 108 0.033450547 -1.1587167698             normal             normal
109 109 0.010222737 -0.3520283143             normal             normal
110 110 0.023366186  1.1354139618             normal             normal
111 111 0.040884122  1.0243345531           leverage           leverage
112 112 0.018492440  0.0937148829             normal             normal
113 113 0.016203307  1.6459429024             normal             normal
114 114 0.013839516  1.2554157147             normal             normal
115 115 0.009016837  2.3559909773            outlier            outlier
116 116 0.019111139 -0.7635191658             normal             normal
117 117 0.005578793 -1.6323381935             normal             normal
118 118 0.017013644  1.7411403007             normal             normal
119 119 0.013153495 -1.0581953789             normal             normal
120 120 0.016962138 -0.1806400874             normal             normal
121 121 0.006236051  1.2960038448             normal             normal
122 122 0.008782123  0.1456903754             normal             normal
123 123 0.020346175  0.2354572097             normal             normal
124 124 0.008896642 -0.3195889441             normal             normal
125 125 0.053141001  0.1128426801           leverage           leverage
126 126 0.007048024 -0.1901603269             normal             normal
127 127 0.012809844  0.8320896124             normal             normal
128 128 0.005753302 -1.9104540241             normal             normal
129 129 0.011374502 -0.1665475040             normal             normal
130 130 0.035901817 -0.4084949452             normal             normal
131 131 0.009524264  0.4765839564             normal             normal
132 132 0.037321670 -0.8872732015             normal             normal
133 133 0.013901672  1.8610380414             normal             normal
134 134 0.009466933 -0.9967369630             normal             normal
135 135 0.018295317  1.5921286954             normal             normal
136 136 0.017749057  2.0424695837            outlier            outlier
137 137 0.008931979 -1.3005825705             normal             normal
138 138 0.012892579 -0.6612591381             normal             normal
139 139 0.028011360 -0.0105387554             normal             normal
140 140 0.008262128  0.6269023965             normal             normal
141 141 0.010509552 -2.4187322569            outlier            outlier
142 142 0.006236051 -1.2875918541             normal             normal
143 143 0.022735873  0.2004370441             normal             normal
144 144 0.015310602 -0.3081322343             normal             normal
145 145 0.008407498 -0.5838887690             normal             normal
146 146 0.012906681 -0.0362707248             normal             normal
147 147 0.040590038 -0.1383922701           leverage           leverage
148 148 0.013672069 -0.2963394272             normal             normal
149 149 0.015201278  0.5174614703             normal             normal
150 150 0.033936080  0.1178180142             normal             normal
151 151 0.018936946  0.7337200979             normal             normal
152 152 0.010741826  1.0762759940             normal             normal
153 153 0.028214013 -0.7091009803             normal             normal
154 154 0.007457168 -0.6418437597             normal             normal
155 155 0.010519730 -0.0742232793             normal             normal
156 156 0.009781974  1.4675437974             normal             normal
157 157 0.007454320 -0.0566833495             normal             normal
158 158 0.010328810 -1.3193821602             normal             normal
159 159 0.016107870 -0.0004592609             normal             normal
160 160 0.019679472  0.3224538910             normal             normal
161 161 0.012649547 -1.1362533725             normal             normal
162 162 0.005661751  0.9570892807             normal             normal
163 163 0.021174819 -1.4292598994             normal             normal
164 164 0.027963108 -1.0817808039             normal             normal
165 165 0.014880784 -0.1273570734             normal             normal
166 166 0.015152319  0.3100580108             normal             normal
167 167 0.012942231 -0.9430087540             normal             normal
168 168 0.024401363 -1.0004205310             normal             normal
169 169 0.013796169 -0.3266552443             normal             normal
170 170 0.011318388  0.4779826970             normal             normal
171 171 0.015692634 -1.1225943231             normal             normal
172 172 0.017221984  0.4290093591             normal             normal
173 173 0.031361961  0.5760876827             normal             normal
174 174 0.010754402  0.0048134988             normal             normal
175 175 0.022042606  0.1356998665             normal             normal
176 176 0.017049213  0.5377568859             normal             normal
177 177 0.020075549  0.6534943450             normal             normal
178 178 0.005119677 -2.0759807456            outlier            outlier
179 179 0.019170721 -0.1408588779             normal             normal
180 180 0.014247870 -1.0289602984             normal             normal
181 181 0.018523463  1.0827262779             normal             normal
182 182 0.014704534 -0.2525935618             normal             normal
183 183 0.020139498 -1.2382939110             normal             normal
184 184 0.019967920 -0.0686983378             normal             normal
185 185 0.019450495 -2.1645087644            outlier            outlier
186 186 0.015595131  0.5376914283             normal             normal
187 187 0.005334097 -0.2505785670             normal             normal
188 188 0.012309618  0.5464032574             normal             normal
189 189 0.010387939  0.9146555195             normal             normal
190 190 0.010301379 -0.1569159057             normal             normal
191 191 0.021343052 -0.4596571444             normal             normal
192 192 0.022523544 -1.8397072164             normal             normal
193 193 0.006063512 -0.4454613699             normal             normal
194 194 0.046608465 -0.4936746801           leverage           leverage
195 195 0.021062171 -1.5018059729             normal             normal
196 196 0.021220962  0.6428872251             normal             normal
197 197 0.022121805  0.2346403284             normal             normal
198 198 0.027120625  0.7210780094             normal             normal
199 199 0.009824188 -0.4691841142             normal             normal
200 200 0.022259921  0.4105220868             normal             normal

$lev_thrsh
[1] 0.04

$minx
[1] 0.005119677

$miny
[1] -5.715729

$maxx
[1] 0.07998748

$maxy
[1] 5.355991

> ols_prep_rstudlev_data(model, threshold = 3)
$levrstud
    obs    leverage      rstudent    color fct_color
1     1 0.016663013  1.5615178576   normal    normal
2     2 0.015958467  1.5674686935   normal    normal
3     3 0.055990789 -0.8622668267 leverage  leverage
4     4 0.013278027  2.1255029597   normal    normal
5     5 0.007234223 -1.0086194988   normal    normal
6     6 0.018982871 -1.5536180050   normal    normal
7     7 0.028207407 -0.0033083160   normal    normal
8     8 0.013469959 -1.4291604750   normal    normal
9     9 0.007794713  1.0654028866   normal    normal
10   10 0.006109328  0.7204677404   normal    normal
11   11 0.009636149  1.3900119349   normal    normal
12   12 0.027302624 -0.1190230101   normal    normal
13   13 0.026214458  1.3622240361   normal    normal
14   14 0.011567201 -0.4650712801   normal    normal
15   15 0.049225149 -0.1522931868 leverage  leverage
16   16 0.012197431 -0.7369695795   normal    normal
17   17 0.005225105 -0.5538375471   normal    normal
18   18 0.008282313 -0.1206769984   normal    normal
19   19 0.016057765  1.2094871126   normal    normal
20   20 0.031691152  0.5875672266   normal    normal
21   21 0.079987477  2.1249199600 leverage  leverage
22   22 0.038690269 -0.8885924544   normal    normal
23   23 0.024796396  0.3989106927   normal    normal
24   24 0.012184872  0.5148854800   normal    normal
25   25 0.013774377 -0.9253782818   normal    normal
26   26 0.021954211 -1.1784121774   normal    normal
27   27 0.016656157  0.3009278833   normal    normal
28   28 0.007015637 -1.3949833362   normal    normal
29   29 0.023947729  0.0687139016   normal    normal
30   30 0.014919053  0.3301869369   normal    normal
31   31 0.060332209 -0.7746718907 leverage  leverage
32   32 0.022532977  2.3453042406   normal    normal
33   33 0.018797715  0.1825653880   normal    normal
34   34 0.068933532 -2.2528504213 leverage  leverage
35   35 0.017763012 -0.4927644910   normal    normal
36   36 0.014536648  0.0173928975   normal    normal
37   37 0.049206361  0.4119453403 leverage  leverage
38   38 0.020025025  0.0813920657   normal    normal
39   39 0.035928203  1.1535955907   normal    normal
40   40 0.031561577  0.0790182178   normal    normal
41   41 0.013572369  0.4986514768   normal    normal
42   42 0.010027638 -0.5841201617   normal    normal
43   43 0.006334353 -0.4439399459   normal    normal
44   44 0.017061392 -0.4647805161   normal    normal
45   45 0.035564567  1.2103260683   normal    normal
46   46 0.021088934 -1.1152833455   normal    normal
47   47 0.022605754  0.9846953174   normal    normal
48   48 0.024263530  0.2037596196   normal    normal
49   49 0.014153579 -1.5841455905   normal    normal
50   50 0.014341980  0.5046561856   normal    normal
51   51 0.009980292 -0.8428749146   normal    normal
52   52 0.033699644 -0.2244305253   normal    normal
53   53 0.027622072 -1.2704393116   normal    normal
54   54 0.013124733  1.4031499379   normal    normal
55   55 0.031840490  0.8388462618   normal    normal
56   56 0.044295731  0.1444303526 leverage  leverage
57   57 0.026517891 -0.2679828969   normal    normal
58   58 0.038734380 -0.4398184906   normal    normal
59   59 0.007307716  1.0105795250   normal    normal
60   60 0.009862399 -0.1085065460   normal    normal
61   61 0.021828959  0.0643870692   normal    normal
62   62 0.020458503 -2.2867946914   normal    normal
63   63 0.022694326  0.6230980698   normal    normal
64   64 0.028589146 -0.6392045195   normal    normal
65   65 0.024840216  0.8728884281   normal    normal
66   66 0.021137375 -0.0139993151   normal    normal
67   67 0.009172486  0.5386382740   normal    normal
68   68 0.017134182  0.4464274622   normal    normal
69   69 0.040440609  0.9891610642 leverage  leverage
70   70 0.033437870  0.8974746735   normal    normal
71   71 0.014044304  0.0266382273   normal    normal
72   72 0.008020965  0.5191148106   normal    normal
73   73 0.025324219  1.0321756789   normal    normal
74   74 0.036634172  0.8269809015   normal    normal
75   75 0.021462694  0.7654046005   normal    normal
76   76 0.014695884  0.5012495411   normal    normal
77   77 0.013395096  0.1647799838   normal    normal
78   78 0.012650645  1.3992743502   normal    normal
79   79 0.023877061 -1.5838362422   normal    normal
80   80 0.023944531 -0.0027914606   normal    normal
81   81 0.007259335  0.9613788128   normal    normal
82   82 0.015743305 -2.7157286565   normal    normal
83   83 0.027927049  0.4544767500   normal    normal
84   84 0.035564567  0.9176207661   normal    normal
85   85 0.015802654  1.8373806393   normal    normal
86   86 0.013593984 -1.0111400482   normal    normal
87   87 0.018450590  0.4099709140   normal    normal
88   88 0.018152864 -1.3353363732   normal    normal
89   89 0.034064291  1.9065087673   normal    normal
90   90 0.020048187 -0.3183460774   normal    normal
91   91 0.033632340 -0.8765367429   normal    normal
92   92 0.033055971  1.2869743107   normal    normal
93   93 0.020615606  0.5489294217   normal    normal
94   94 0.013566003 -1.2341012351   normal    normal
95   95 0.009552626 -0.3135792639   normal    normal
96   96 0.012218735 -1.5716965630   normal    normal
97   97 0.026586251  0.6272069017   normal    normal
98   98 0.026388503 -0.6031937785   normal    normal
99   99 0.015834328 -1.0867225368   normal    normal
100 100 0.020602109 -0.0814710621   normal    normal
101 101 0.020879765  0.6722859307   normal    normal
102 102 0.017775829 -1.7650237091   normal    normal
103 103 0.028718728  0.4855645788   normal    normal
104 104 0.005818563  1.5805326069   normal    normal
105 105 0.012942231 -0.6547693963   normal    normal
106 106 0.045440580  0.0510560203 leverage  leverage
107 107 0.029142127  0.1004793698   normal    normal
108 108 0.033450547 -1.1587167698   normal    normal
109 109 0.010222737 -0.3520283143   normal    normal
110 110 0.023366186  1.1354139618   normal    normal
111 111 0.040884122  1.0243345531 leverage  leverage
112 112 0.018492440  0.0937148829   normal    normal
113 113 0.016203307  1.6459429024   normal    normal
114 114 0.013839516  1.2554157147   normal    normal
115 115 0.009016837  2.3559909773   normal    normal
116 116 0.019111139 -0.7635191658   normal    normal
117 117 0.005578793 -1.6323381935   normal    normal
118 118 0.017013644  1.7411403007   normal    normal
119 119 0.013153495 -1.0581953789   normal    normal
120 120 0.016962138 -0.1806400874   normal    normal
121 121 0.006236051  1.2960038448   normal    normal
122 122 0.008782123  0.1456903754   normal    normal
123 123 0.020346175  0.2354572097   normal    normal
124 124 0.008896642 -0.3195889441   normal    normal
125 125 0.053141001  0.1128426801 leverage  leverage
126 126 0.007048024 -0.1901603269   normal    normal
127 127 0.012809844  0.8320896124   normal    normal
128 128 0.005753302 -1.9104540241   normal    normal
129 129 0.011374502 -0.1665475040   normal    normal
130 130 0.035901817 -0.4084949452   normal    normal
131 131 0.009524264  0.4765839564   normal    normal
132 132 0.037321670 -0.8872732015   normal    normal
133 133 0.013901672  1.8610380414   normal    normal
134 134 0.009466933 -0.9967369630   normal    normal
135 135 0.018295317  1.5921286954   normal    normal
136 136 0.017749057  2.0424695837   normal    normal
137 137 0.008931979 -1.3005825705   normal    normal
138 138 0.012892579 -0.6612591381   normal    normal
139 139 0.028011360 -0.0105387554   normal    normal
140 140 0.008262128  0.6269023965   normal    normal
141 141 0.010509552 -2.4187322569   normal    normal
142 142 0.006236051 -1.2875918541   normal    normal
143 143 0.022735873  0.2004370441   normal    normal
144 144 0.015310602 -0.3081322343   normal    normal
145 145 0.008407498 -0.5838887690   normal    normal
146 146 0.012906681 -0.0362707248   normal    normal
147 147 0.040590038 -0.1383922701 leverage  leverage
148 148 0.013672069 -0.2963394272   normal    normal
149 149 0.015201278  0.5174614703   normal    normal
150 150 0.033936080  0.1178180142   normal    normal
151 151 0.018936946  0.7337200979   normal    normal
152 152 0.010741826  1.0762759940   normal    normal
153 153 0.028214013 -0.7091009803   normal    normal
154 154 0.007457168 -0.6418437597   normal    normal
155 155 0.010519730 -0.0742232793   normal    normal
156 156 0.009781974  1.4675437974   normal    normal
157 157 0.007454320 -0.0566833495   normal    normal
158 158 0.010328810 -1.3193821602   normal    normal
159 159 0.016107870 -0.0004592609   normal    normal
160 160 0.019679472  0.3224538910   normal    normal
161 161 0.012649547 -1.1362533725   normal    normal
162 162 0.005661751  0.9570892807   normal    normal
163 163 0.021174819 -1.4292598994   normal    normal
164 164 0.027963108 -1.0817808039   normal    normal
165 165 0.014880784 -0.1273570734   normal    normal
166 166 0.015152319  0.3100580108   normal    normal
167 167 0.012942231 -0.9430087540   normal    normal
168 168 0.024401363 -1.0004205310   normal    normal
169 169 0.013796169 -0.3266552443   normal    normal
170 170 0.011318388  0.4779826970   normal    normal
171 171 0.015692634 -1.1225943231   normal    normal
172 172 0.017221984  0.4290093591   normal    normal
173 173 0.031361961  0.5760876827   normal    normal
174 174 0.010754402  0.0048134988   normal    normal
175 175 0.022042606  0.1356998665   normal    normal
176 176 0.017049213  0.5377568859   normal    normal
177 177 0.020075549  0.6534943450   normal    normal
178 178 0.005119677 -2.0759807456   normal    normal
179 179 0.019170721 -0.1408588779   normal    normal
180 180 0.014247870 -1.0289602984   normal    normal
181 181 0.018523463  1.0827262779   normal    normal
182 182 0.014704534 -0.2525935618   normal    normal
183 183 0.020139498 -1.2382939110   normal    normal
184 184 0.019967920 -0.0686983378   normal    normal
185 185 0.019450495 -2.1645087644   normal    normal
186 186 0.015595131  0.5376914283   normal    normal
187 187 0.005334097 -0.2505785670   normal    normal
188 188 0.012309618  0.5464032574   normal    normal
189 189 0.010387939  0.9146555195   normal    normal
190 190 0.010301379 -0.1569159057   normal    normal
191 191 0.021343052 -0.4596571444   normal    normal
192 192 0.022523544 -1.8397072164   normal    normal
193 193 0.006063512 -0.4454613699   normal    normal
194 194 0.046608465 -0.4936746801 leverage  leverage
195 195 0.021062171 -1.5018059729   normal    normal
196 196 0.021220962  0.6428872251   normal    normal
197 197 0.022121805  0.2346403284   normal    normal
198 198 0.027120625  0.7210780094   normal    normal
199 199 0.009824188 -0.4691841142   normal    normal
200 200 0.022259921  0.4105220868   normal    normal

$lev_thrsh
[1] 0.04

$minx
[1] 0.005119677

$miny
[1] -5.715729

$maxx
[1] 0.07998748

$maxy
[1] 5.355991

> 
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_rvsrplot_data")
> ### * ols_prep_rvsrplot_data
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_rvsrplot_data
> ### Title: Residual vs regressor plot data
> ### Aliases: ols_prep_rvsrplot_data
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_prep_rvsrplot_data(model)
$np
[1] 4

$dat
                     disp  hp    wt  qsec
Mazda RX4           160.0 110 2.620 16.46
Mazda RX4 Wag       160.0 110 2.875 17.02
Datsun 710          108.0  93 2.320 18.61
Hornet 4 Drive      258.0 110 3.215 19.44
Hornet Sportabout   360.0 175 3.440 17.02
Valiant             225.0 105 3.460 20.22
Duster 360          360.0 245 3.570 15.84
Merc 240D           146.7  62 3.190 20.00
Merc 230            140.8  95 3.150 22.90
Merc 280            167.6 123 3.440 18.30
Merc 280C           167.6 123 3.440 18.90
Merc 450SE          275.8 180 4.070 17.40
Merc 450SL          275.8 180 3.730 17.60
Merc 450SLC         275.8 180 3.780 18.00
Cadillac Fleetwood  472.0 205 5.250 17.98
Lincoln Continental 460.0 215 5.424 17.82
Chrysler Imperial   440.0 230 5.345 17.42
Fiat 128             78.7  66 2.200 19.47
Honda Civic          75.7  52 1.615 18.52
Toyota Corolla       71.1  65 1.835 19.90
Toyota Corona       120.1  97 2.465 20.01
Dodge Challenger    318.0 150 3.520 16.87
AMC Javelin         304.0 150 3.435 17.30
Camaro Z28          350.0 245 3.840 15.41
Pontiac Firebird    400.0 175 3.845 17.05
Fiat X1-9            79.0  66 1.935 18.90
Porsche 914-2       120.3  91 2.140 16.70
Lotus Europa         95.1 113 1.513 16.90
Ford Pantera L      351.0 264 3.170 14.50
Ferrari Dino        145.0 175 2.770 15.50
Maserati Bora       301.0 335 3.570 14.60
Volvo 142E          121.0 109 2.780 18.60

$pnames
[1] "disp" "hp"   "wt"   "qsec"

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_srchart_data")
> ### * ols_prep_srchart_data
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_srchart_data
> ### Title: Standardized residual chart data
> ### Aliases: ols_prep_srchart_data
> 
> ### ** Examples
> 
> model <- lm(read ~ write + math + science, data = hsb)
> ols_prep_srchart_data(model)
    obs        sdres   color fct_color txt
1     1  1.555819633  normal    normal  NA
2     2  1.561675116  normal    normal  NA
3     3 -0.862831585  normal    normal  NA
4     4  2.106681912 outlier   outlier   4
5     5 -1.008574955  normal    normal  NA
6     6 -1.548045087  normal    normal  NA
7     7 -0.003316788  normal    normal  NA
8     8 -1.425374806  normal    normal  NA
9     9  1.065035938  normal    normal  NA
10   10  0.721353278  normal    normal  NA
11   11  1.386718381  normal    normal  NA
12   12 -0.119323473  normal    normal  NA
13   13  1.359260285  normal    normal  NA
14   14 -0.466003875  normal    normal  NA
15   15 -0.152674104  normal    normal  NA
16   16 -0.737830022  normal    normal  NA
17   17 -0.554819632  normal    normal  NA
18   18 -0.120981513  normal    normal  NA
19   19  1.208061519  normal    normal  NA
20   20  0.588551117  normal    normal  NA
21   21  2.106117154 outlier   outlier  21
22   22 -0.889069785  normal    normal  NA
23   23  0.399769150  normal    normal  NA
24   24  0.515853473  normal    normal  NA
25   25 -0.925717636  normal    normal  NA
26   26 -1.177245555  normal    normal  NA
27   27  0.301628477  normal    normal  NA
28   28 -1.391629085  normal    normal  NA
29   29  0.068889032  normal    normal  NA
30   30  0.330939987  normal    normal  NA
31   31 -0.775463353  normal    normal  NA
32   32  2.318833396 outlier   outlier  32
33   33  0.183017265  normal    normal  NA
34   34 -2.229788221 outlier   outlier  34
35   35 -0.493719077  normal    normal  NA
36   36  0.017437424  normal    normal  NA
37   37  0.412820670  normal    normal  NA
38   38  0.081599110  normal    normal  NA
39   39  1.152623378  normal    normal  NA
40   40  0.079219301  normal    normal  NA
41   41  0.499609999  normal    normal  NA
42   42 -0.585104328  normal    normal  NA
43   43 -0.444852053  normal    normal  NA
44   44 -0.465712850  normal    normal  NA
45   45  1.208893240  normal    normal  NA
46   46 -1.114590192  normal    normal  NA
47   47  0.984771628  normal    normal  NA
48   48  0.204259668  normal    normal  NA
49   49 -1.578080360  normal    normal  NA
50   50  0.505618450  normal    normal  NA
51   51 -0.843498219  normal    normal  NA
52   52 -0.224976198  normal    normal  NA
53   53 -1.268454000  normal    normal  NA
54   54  1.399694850  normal    normal  NA
55   55  0.839481117  normal    normal  NA
56   56  0.144792469  normal    normal  NA
57   57 -0.268619695  normal    normal  NA
58   58 -0.440726242  normal    normal  NA
59   59  1.010524693  normal    normal  NA
60   60 -0.108781128  normal    normal  NA
61   61  0.064551267  normal    normal  NA
62   62 -2.262513898 outlier   outlier  62
63   63  0.624072749  normal    normal  NA
64   64 -0.640171087  normal    normal  NA
65   65  0.873419026  normal    normal  NA
66   66 -0.014035158  normal    normal  NA
67   67  0.539616346  normal    normal  NA
68   68  0.447342142  normal    normal  NA
69   69  0.989215474  normal    normal  NA
70   70  0.897920398  normal    normal  NA
71   71  0.026706394  normal    normal  NA
72   72  0.520084931  normal    normal  NA
73   73  1.032003552  normal    normal  NA
74   74  0.827648573  normal    normal  NA
75   75  0.766214550  normal    normal  NA
76   76  0.502209717  normal    normal  NA
77   77  0.165190456  normal    normal  NA
78   78  1.395867291  normal    normal  NA
79   79 -1.577776110  normal    normal  NA
80   80 -0.002798609  normal    normal  NA
81   81  0.961564645  normal    normal  NA
82   82 -2.672611202 outlier   outlier  82
83   83  0.455399463  normal    normal  NA
84   84  0.917990782  normal    normal  NA
85   85  1.826344254  normal    normal  NA
86   86 -1.011082263  normal    normal  NA
87   87  0.410843756  normal    normal  NA
88   88 -1.332676655  normal    normal  NA
89   89  1.893822187  normal    normal  NA
90   90 -0.319078402  normal    normal  NA
91   91 -0.877055261  normal    normal  NA
92   92  1.284825000  normal    normal  NA
93   93  0.549910423  normal    normal  NA
94   94 -1.232457987  normal    normal  NA
95   95 -0.314303049  normal    normal  NA
96   96 -1.565834736  normal    normal  NA
97   97  0.628179750  normal    normal  NA
98   98 -0.604175061  normal    normal  NA
99   99 -1.086221201  normal    normal  NA
100 100 -0.081678305  normal    normal  NA
101 101  0.673227789  normal    normal  NA
102 102 -1.755575702  normal    normal  NA
103 103  0.486513993  normal    normal  NA
104 104  1.574526785  normal    normal  NA
105 105 -0.655725709  normal    normal  NA
106 106  0.051186424  normal    normal  NA
107 107  0.100734072  normal    normal  NA
108 108 -1.157705328  normal    normal  NA
109 109 -0.352817705  normal    normal  NA
110 110  1.134577332  normal    normal  NA
111 111  1.024205853  normal    normal  NA
112 112  0.093952754  normal    normal  NA
113 113  1.638813153  normal    normal  NA
114 114  1.253574859  normal    normal  NA
115 115  2.329107718 outlier   outlier 115
116 116 -0.764332752  normal    normal  NA
117 117 -1.625450724  normal    normal  NA
118 118  1.732186258  normal    normal  NA
119 119 -1.057872190  normal    normal  NA
120 120 -0.181087524  normal    normal  NA
121 121  1.293762738  normal    normal  NA
122 122  0.146055514  normal    normal  NA
123 123  0.236026624  normal    normal  NA
124 124 -0.320323477  normal    normal  NA
125 125  0.113127957  normal    normal  NA
126 126 -0.190629620  normal    normal  NA
127 127  0.832743375  normal    normal  NA
128 128 -1.897669259  normal    normal  NA
129 129 -0.166962128  normal    normal  NA
130 130 -0.409365912  normal    normal  NA
131 131  0.477526378  normal    normal  NA
132 132 -0.887755135  normal    normal  NA
133 133  1.849451744  normal    normal  NA
134 134 -0.996753530  normal    normal  NA
135 135  1.585931101  normal    normal  NA
136 136  2.026141808 outlier   outlier 136
137 137 -1.298294306  normal    normal  NA
138 138 -0.662210459  normal    normal  NA
139 139 -0.010565740  normal    normal  NA
140 140  0.627875386  normal    normal  NA
141 141 -2.389349205 outlier   outlier 141
142 142 -1.285436316  normal    normal  NA
143 143  0.200929631  normal    normal  NA
144 144 -0.308846127  normal    normal  NA
145 145 -0.584872950  normal    normal  NA
146 146 -0.036363485  normal    normal  NA
147 147 -0.138739855  normal    normal  NA
148 148 -0.297031425  normal    normal  NA
149 149  0.518430776  normal    normal  NA
150 150  0.118115521  normal    normal  NA
151 151  0.734585723  normal    normal  NA
152 152  1.075841436  normal    normal  NA
153 153 -0.710002052  normal    normal  NA
154 154 -0.642808757  normal    normal  NA
155 155 -0.074412301  normal    normal  NA
156 156  1.463243682  normal    normal  NA
157 157 -0.056828037  normal    normal  NA
158 158 -1.316895946  normal    normal  NA
159 159 -0.000460437  normal    normal  NA
160 160  0.323193485  normal    normal  NA
161 161 -1.135410609  normal    normal  NA
162 162  0.957294389  normal    normal  NA
163 163 -1.425472939  normal    normal  NA
164 164 -1.081311281  normal    normal  NA
165 165 -0.127677902  normal    normal  NA
166 166  0.310775417  normal    normal  NA
167 167 -0.943275254  normal    normal  NA
168 168 -1.000418384  normal    normal  NA
169 169 -0.327402186  normal    normal  NA
170 170  0.478926247  normal    normal  NA
171 171 -1.121849862  normal    normal  NA
172 172  0.429905143  normal    normal  NA
173 173  0.577072081  normal    normal  NA
174 174  0.004825825  normal    normal  NA
175 175  0.136040947  normal    normal  NA
176 176  0.538734666  normal    normal  NA
177 177  0.654451588  normal    normal  NA
178 178 -2.058671932 outlier   outlier 178
179 179 -0.141212409  normal    normal  NA
180 180 -1.028806096  normal    normal  NA
181 181  1.082250700  normal    normal  NA
182 182 -0.253198990  normal    normal  NA
183 183 -1.236612467  normal    normal  NA
184 184 -0.068873429  normal    normal  NA
185 185 -2.144443243 outlier   outlier 185
186 186  0.538669187  normal    normal  NA
187 187 -0.251179818  normal    normal  NA
188 188  0.547383622  normal    normal  NA
189 189  0.915037032  normal    normal  NA
190 190 -0.157307808  normal    normal  NA
191 191 -0.460584788  normal    normal  NA
192 192 -1.828617426  normal    normal  NA
193 193 -0.446375056  normal    normal  NA
194 194 -0.494629892  normal    normal  NA
195 195 -1.497019264  normal    normal  NA
196 196  0.643851583  normal    normal  NA
197 197  0.235207999  normal    normal  NA
198 198  0.721962673  normal    normal  NA
199 199 -0.470120330  normal    normal  NA
200 200  0.411395626  normal    normal  NA
> ols_prep_srchart_data(model, threshold = 3)
    obs        sdres  color fct_color txt
1     1  1.555819633 normal    normal  NA
2     2  1.561675116 normal    normal  NA
3     3 -0.862831585 normal    normal  NA
4     4  2.106681912 normal    normal  NA
5     5 -1.008574955 normal    normal  NA
6     6 -1.548045087 normal    normal  NA
7     7 -0.003316788 normal    normal  NA
8     8 -1.425374806 normal    normal  NA
9     9  1.065035938 normal    normal  NA
10   10  0.721353278 normal    normal  NA
11   11  1.386718381 normal    normal  NA
12   12 -0.119323473 normal    normal  NA
13   13  1.359260285 normal    normal  NA
14   14 -0.466003875 normal    normal  NA
15   15 -0.152674104 normal    normal  NA
16   16 -0.737830022 normal    normal  NA
17   17 -0.554819632 normal    normal  NA
18   18 -0.120981513 normal    normal  NA
19   19  1.208061519 normal    normal  NA
20   20  0.588551117 normal    normal  NA
21   21  2.106117154 normal    normal  NA
22   22 -0.889069785 normal    normal  NA
23   23  0.399769150 normal    normal  NA
24   24  0.515853473 normal    normal  NA
25   25 -0.925717636 normal    normal  NA
26   26 -1.177245555 normal    normal  NA
27   27  0.301628477 normal    normal  NA
28   28 -1.391629085 normal    normal  NA
29   29  0.068889032 normal    normal  NA
30   30  0.330939987 normal    normal  NA
31   31 -0.775463353 normal    normal  NA
32   32  2.318833396 normal    normal  NA
33   33  0.183017265 normal    normal  NA
34   34 -2.229788221 normal    normal  NA
35   35 -0.493719077 normal    normal  NA
36   36  0.017437424 normal    normal  NA
37   37  0.412820670 normal    normal  NA
38   38  0.081599110 normal    normal  NA
39   39  1.152623378 normal    normal  NA
40   40  0.079219301 normal    normal  NA
41   41  0.499609999 normal    normal  NA
42   42 -0.585104328 normal    normal  NA
43   43 -0.444852053 normal    normal  NA
44   44 -0.465712850 normal    normal  NA
45   45  1.208893240 normal    normal  NA
46   46 -1.114590192 normal    normal  NA
47   47  0.984771628 normal    normal  NA
48   48  0.204259668 normal    normal  NA
49   49 -1.578080360 normal    normal  NA
50   50  0.505618450 normal    normal  NA
51   51 -0.843498219 normal    normal  NA
52   52 -0.224976198 normal    normal  NA
53   53 -1.268454000 normal    normal  NA
54   54  1.399694850 normal    normal  NA
55   55  0.839481117 normal    normal  NA
56   56  0.144792469 normal    normal  NA
57   57 -0.268619695 normal    normal  NA
58   58 -0.440726242 normal    normal  NA
59   59  1.010524693 normal    normal  NA
60   60 -0.108781128 normal    normal  NA
61   61  0.064551267 normal    normal  NA
62   62 -2.262513898 normal    normal  NA
63   63  0.624072749 normal    normal  NA
64   64 -0.640171087 normal    normal  NA
65   65  0.873419026 normal    normal  NA
66   66 -0.014035158 normal    normal  NA
67   67  0.539616346 normal    normal  NA
68   68  0.447342142 normal    normal  NA
69   69  0.989215474 normal    normal  NA
70   70  0.897920398 normal    normal  NA
71   71  0.026706394 normal    normal  NA
72   72  0.520084931 normal    normal  NA
73   73  1.032003552 normal    normal  NA
74   74  0.827648573 normal    normal  NA
75   75  0.766214550 normal    normal  NA
76   76  0.502209717 normal    normal  NA
77   77  0.165190456 normal    normal  NA
78   78  1.395867291 normal    normal  NA
79   79 -1.577776110 normal    normal  NA
80   80 -0.002798609 normal    normal  NA
81   81  0.961564645 normal    normal  NA
82   82 -2.672611202 normal    normal  NA
83   83  0.455399463 normal    normal  NA
84   84  0.917990782 normal    normal  NA
85   85  1.826344254 normal    normal  NA
86   86 -1.011082263 normal    normal  NA
87   87  0.410843756 normal    normal  NA
88   88 -1.332676655 normal    normal  NA
89   89  1.893822187 normal    normal  NA
90   90 -0.319078402 normal    normal  NA
91   91 -0.877055261 normal    normal  NA
92   92  1.284825000 normal    normal  NA
93   93  0.549910423 normal    normal  NA
94   94 -1.232457987 normal    normal  NA
95   95 -0.314303049 normal    normal  NA
96   96 -1.565834736 normal    normal  NA
97   97  0.628179750 normal    normal  NA
98   98 -0.604175061 normal    normal  NA
99   99 -1.086221201 normal    normal  NA
100 100 -0.081678305 normal    normal  NA
101 101  0.673227789 normal    normal  NA
102 102 -1.755575702 normal    normal  NA
103 103  0.486513993 normal    normal  NA
104 104  1.574526785 normal    normal  NA
105 105 -0.655725709 normal    normal  NA
106 106  0.051186424 normal    normal  NA
107 107  0.100734072 normal    normal  NA
108 108 -1.157705328 normal    normal  NA
109 109 -0.352817705 normal    normal  NA
110 110  1.134577332 normal    normal  NA
111 111  1.024205853 normal    normal  NA
112 112  0.093952754 normal    normal  NA
113 113  1.638813153 normal    normal  NA
114 114  1.253574859 normal    normal  NA
115 115  2.329107718 normal    normal  NA
116 116 -0.764332752 normal    normal  NA
117 117 -1.625450724 normal    normal  NA
118 118  1.732186258 normal    normal  NA
119 119 -1.057872190 normal    normal  NA
120 120 -0.181087524 normal    normal  NA
121 121  1.293762738 normal    normal  NA
122 122  0.146055514 normal    normal  NA
123 123  0.236026624 normal    normal  NA
124 124 -0.320323477 normal    normal  NA
125 125  0.113127957 normal    normal  NA
126 126 -0.190629620 normal    normal  NA
127 127  0.832743375 normal    normal  NA
128 128 -1.897669259 normal    normal  NA
129 129 -0.166962128 normal    normal  NA
130 130 -0.409365912 normal    normal  NA
131 131  0.477526378 normal    normal  NA
132 132 -0.887755135 normal    normal  NA
133 133  1.849451744 normal    normal  NA
134 134 -0.996753530 normal    normal  NA
135 135  1.585931101 normal    normal  NA
136 136  2.026141808 normal    normal  NA
137 137 -1.298294306 normal    normal  NA
138 138 -0.662210459 normal    normal  NA
139 139 -0.010565740 normal    normal  NA
140 140  0.627875386 normal    normal  NA
141 141 -2.389349205 normal    normal  NA
142 142 -1.285436316 normal    normal  NA
143 143  0.200929631 normal    normal  NA
144 144 -0.308846127 normal    normal  NA
145 145 -0.584872950 normal    normal  NA
146 146 -0.036363485 normal    normal  NA
147 147 -0.138739855 normal    normal  NA
148 148 -0.297031425 normal    normal  NA
149 149  0.518430776 normal    normal  NA
150 150  0.118115521 normal    normal  NA
151 151  0.734585723 normal    normal  NA
152 152  1.075841436 normal    normal  NA
153 153 -0.710002052 normal    normal  NA
154 154 -0.642808757 normal    normal  NA
155 155 -0.074412301 normal    normal  NA
156 156  1.463243682 normal    normal  NA
157 157 -0.056828037 normal    normal  NA
158 158 -1.316895946 normal    normal  NA
159 159 -0.000460437 normal    normal  NA
160 160  0.323193485 normal    normal  NA
161 161 -1.135410609 normal    normal  NA
162 162  0.957294389 normal    normal  NA
163 163 -1.425472939 normal    normal  NA
164 164 -1.081311281 normal    normal  NA
165 165 -0.127677902 normal    normal  NA
166 166  0.310775417 normal    normal  NA
167 167 -0.943275254 normal    normal  NA
168 168 -1.000418384 normal    normal  NA
169 169 -0.327402186 normal    normal  NA
170 170  0.478926247 normal    normal  NA
171 171 -1.121849862 normal    normal  NA
172 172  0.429905143 normal    normal  NA
173 173  0.577072081 normal    normal  NA
174 174  0.004825825 normal    normal  NA
175 175  0.136040947 normal    normal  NA
176 176  0.538734666 normal    normal  NA
177 177  0.654451588 normal    normal  NA
178 178 -2.058671932 normal    normal  NA
179 179 -0.141212409 normal    normal  NA
180 180 -1.028806096 normal    normal  NA
181 181  1.082250700 normal    normal  NA
182 182 -0.253198990 normal    normal  NA
183 183 -1.236612467 normal    normal  NA
184 184 -0.068873429 normal    normal  NA
185 185 -2.144443243 normal    normal  NA
186 186  0.538669187 normal    normal  NA
187 187 -0.251179818 normal    normal  NA
188 188  0.547383622 normal    normal  NA
189 189  0.915037032 normal    normal  NA
190 190 -0.157307808 normal    normal  NA
191 191 -0.460584788 normal    normal  NA
192 192 -1.828617426 normal    normal  NA
193 193 -0.446375056 normal    normal  NA
194 194 -0.494629892 normal    normal  NA
195 195 -1.497019264 normal    normal  NA
196 196  0.643851583 normal    normal  NA
197 197  0.235207999 normal    normal  NA
198 198  0.721962673 normal    normal  NA
199 199 -0.470120330 normal    normal  NA
200 200  0.411395626 normal    normal  NA
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_prep_srplot_data")
> ### * ols_prep_srplot_data
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_prep_srplot_data
> ### Title: Studentized residual plot data
> ### Aliases: ols_prep_srplot_data
> 
> ### ** Examples
> 
> model <- lm(read ~ write + math + science, data = hsb)
> ols_prep_srplot_data(model)
$cminx
[1] -4

$cmaxx
[1] 4

$nseq
[1] -1 -2 -3

$pseq
[1] 1 2 3

$dsr
    obs           dsr  color fct_color
1     1  1.5615178576 normal    normal
2     2  1.5674686935 normal    normal
3     3 -0.8622668267 normal    normal
4     4  2.1255029597 normal    normal
5     5 -1.0086194988 normal    normal
6     6 -1.5536180050 normal    normal
7     7 -0.0033083160 normal    normal
8     8 -1.4291604750 normal    normal
9     9  1.0654028866 normal    normal
10   10  0.7204677404 normal    normal
11   11  1.3900119349 normal    normal
12   12 -0.1190230101 normal    normal
13   13  1.3622240361 normal    normal
14   14 -0.4650712801 normal    normal
15   15 -0.1522931868 normal    normal
16   16 -0.7369695795 normal    normal
17   17 -0.5538375471 normal    normal
18   18 -0.1206769984 normal    normal
19   19  1.2094871126 normal    normal
20   20  0.5875672266 normal    normal
21   21  2.1249199600 normal    normal
22   22 -0.8885924544 normal    normal
23   23  0.3989106927 normal    normal
24   24  0.5148854800 normal    normal
25   25 -0.9253782818 normal    normal
26   26 -1.1784121774 normal    normal
27   27  0.3009278833 normal    normal
28   28 -1.3949833362 normal    normal
29   29  0.0687139016 normal    normal
30   30  0.3301869369 normal    normal
31   31 -0.7746718907 normal    normal
32   32  2.3453042406 normal    normal
33   33  0.1825653880 normal    normal
34   34 -2.2528504213 normal    normal
35   35 -0.4927644910 normal    normal
36   36  0.0173928975 normal    normal
37   37  0.4119453403 normal    normal
38   38  0.0813920657 normal    normal
39   39  1.1535955907 normal    normal
40   40  0.0790182178 normal    normal
41   41  0.4986514768 normal    normal
42   42 -0.5841201617 normal    normal
43   43 -0.4439399459 normal    normal
44   44 -0.4647805161 normal    normal
45   45  1.2103260683 normal    normal
46   46 -1.1152833455 normal    normal
47   47  0.9846953174 normal    normal
48   48  0.2037596196 normal    normal
49   49 -1.5841455905 normal    normal
50   50  0.5046561856 normal    normal
51   51 -0.8428749146 normal    normal
52   52 -0.2244305253 normal    normal
53   53 -1.2704393116 normal    normal
54   54  1.4031499379 normal    normal
55   55  0.8388462618 normal    normal
56   56  0.1444303526 normal    normal
57   57 -0.2679828969 normal    normal
58   58 -0.4398184906 normal    normal
59   59  1.0105795250 normal    normal
60   60 -0.1085065460 normal    normal
61   61  0.0643870692 normal    normal
62   62 -2.2867946914 normal    normal
63   63  0.6230980698 normal    normal
64   64 -0.6392045195 normal    normal
65   65  0.8728884281 normal    normal
66   66 -0.0139993151 normal    normal
67   67  0.5386382740 normal    normal
68   68  0.4464274622 normal    normal
69   69  0.9891610642 normal    normal
70   70  0.8974746735 normal    normal
71   71  0.0266382273 normal    normal
72   72  0.5191148106 normal    normal
73   73  1.0321756789 normal    normal
74   74  0.8269809015 normal    normal
75   75  0.7654046005 normal    normal
76   76  0.5012495411 normal    normal
77   77  0.1647799838 normal    normal
78   78  1.3992743502 normal    normal
79   79 -1.5838362422 normal    normal
80   80 -0.0027914606 normal    normal
81   81  0.9613788128 normal    normal
82   82 -2.7157286565 normal    normal
83   83  0.4544767500 normal    normal
84   84  0.9176207661 normal    normal
85   85  1.8373806393 normal    normal
86   86 -1.0111400482 normal    normal
87   87  0.4099709140 normal    normal
88   88 -1.3353363732 normal    normal
89   89  1.9065087673 normal    normal
90   90 -0.3183460774 normal    normal
91   91 -0.8765367429 normal    normal
92   92  1.2869743107 normal    normal
93   93  0.5489294217 normal    normal
94   94 -1.2341012351 normal    normal
95   95 -0.3135792639 normal    normal
96   96 -1.5716965630 normal    normal
97   97  0.6272069017 normal    normal
98   98 -0.6031937785 normal    normal
99   99 -1.0867225368 normal    normal
100 100 -0.0814710621 normal    normal
101 101  0.6722859307 normal    normal
102 102 -1.7650237091 normal    normal
103 103  0.4855645788 normal    normal
104 104  1.5805326069 normal    normal
105 105 -0.6547693963 normal    normal
106 106  0.0510560203 normal    normal
107 107  0.1004793698 normal    normal
108 108 -1.1587167698 normal    normal
109 109 -0.3520283143 normal    normal
110 110  1.1354139618 normal    normal
111 111  1.0243345531 normal    normal
112 112  0.0937148829 normal    normal
113 113  1.6459429024 normal    normal
114 114  1.2554157147 normal    normal
115 115  2.3559909773 normal    normal
116 116 -0.7635191658 normal    normal
117 117 -1.6323381935 normal    normal
118 118  1.7411403007 normal    normal
119 119 -1.0581953789 normal    normal
120 120 -0.1806400874 normal    normal
121 121  1.2960038448 normal    normal
122 122  0.1456903754 normal    normal
123 123  0.2354572097 normal    normal
124 124 -0.3195889441 normal    normal
125 125  0.1128426801 normal    normal
126 126 -0.1901603269 normal    normal
127 127  0.8320896124 normal    normal
128 128 -1.9104540241 normal    normal
129 129 -0.1665475040 normal    normal
130 130 -0.4084949452 normal    normal
131 131  0.4765839564 normal    normal
132 132 -0.8872732015 normal    normal
133 133  1.8610380414 normal    normal
134 134 -0.9967369630 normal    normal
135 135  1.5921286954 normal    normal
136 136  2.0424695837 normal    normal
137 137 -1.3005825705 normal    normal
138 138 -0.6612591381 normal    normal
139 139 -0.0105387554 normal    normal
140 140  0.6269023965 normal    normal
141 141 -2.4187322569 normal    normal
142 142 -1.2875918541 normal    normal
143 143  0.2004370441 normal    normal
144 144 -0.3081322343 normal    normal
145 145 -0.5838887690 normal    normal
146 146 -0.0362707248 normal    normal
147 147 -0.1383922701 normal    normal
148 148 -0.2963394272 normal    normal
149 149  0.5174614703 normal    normal
150 150  0.1178180142 normal    normal
151 151  0.7337200979 normal    normal
152 152  1.0762759940 normal    normal
153 153 -0.7091009803 normal    normal
154 154 -0.6418437597 normal    normal
155 155 -0.0742232793 normal    normal
156 156  1.4675437974 normal    normal
157 157 -0.0566833495 normal    normal
158 158 -1.3193821602 normal    normal
159 159 -0.0004592609 normal    normal
160 160  0.3224538910 normal    normal
161 161 -1.1362533725 normal    normal
162 162  0.9570892807 normal    normal
163 163 -1.4292598994 normal    normal
164 164 -1.0817808039 normal    normal
165 165 -0.1273570734 normal    normal
166 166  0.3100580108 normal    normal
167 167 -0.9430087540 normal    normal
168 168 -1.0004205310 normal    normal
169 169 -0.3266552443 normal    normal
170 170  0.4779826970 normal    normal
171 171 -1.1225943231 normal    normal
172 172  0.4290093591 normal    normal
173 173  0.5760876827 normal    normal
174 174  0.0048134988 normal    normal
175 175  0.1356998665 normal    normal
176 176  0.5377568859 normal    normal
177 177  0.6534943450 normal    normal
178 178 -2.0759807456 normal    normal
179 179 -0.1408588779 normal    normal
180 180 -1.0289602984 normal    normal
181 181  1.0827262779 normal    normal
182 182 -0.2525935618 normal    normal
183 183 -1.2382939110 normal    normal
184 184 -0.0686983378 normal    normal
185 185 -2.1645087644 normal    normal
186 186  0.5376914283 normal    normal
187 187 -0.2505785670 normal    normal
188 188  0.5464032574 normal    normal
189 189  0.9146555195 normal    normal
190 190 -0.1569159057 normal    normal
191 191 -0.4596571444 normal    normal
192 192 -1.8397072164 normal    normal
193 193 -0.4454613699 normal    normal
194 194 -0.4936746801 normal    normal
195 195 -1.5018059729 normal    normal
196 196  0.6428872251 normal    normal
197 197  0.2346403284 normal    normal
198 198  0.7210780094 normal    normal
199 199 -0.4691841142 normal    normal
200 200  0.4105220868 normal    normal

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_press")
> ### * ols_press
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_press
> ### Title: PRESS
> ### Aliases: ols_press
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_press(model)
[1] 257.8314
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_pure_error_anova")
> ### * ols_pure_error_anova
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_pure_error_anova
> ### Title: Lack of fit F test
> ### Aliases: ols_pure_error_anova
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp, data = mtcars)
> ols_pure_error_anova(model)
Lack of Fit F Test 
-----------------
Response :   mpg 
Predictor:   disp 

                      Analysis of Variance Table                       
----------------------------------------------------------------------
                DF     Sum Sq     Mean Sq     F Value        Pr(>F)    
----------------------------------------------------------------------
disp             1    808.8885    808.8885    314.0095    1.934413e-17 
Residual        30    317.1587    10.57196                             
 Lack of fit    25    304.2787    12.17115    4.724824      0.04563623 
 Pure Error      5       12.88       2.576                             
----------------------------------------------------------------------
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_regress")
> ### * ols_regress
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_regress
> ### Title: Ordinary least squares regression
> ### Aliases: ols_regress ols_regress.lm
> 
> ### ** Examples
> 
> ols_regress(mpg ~ disp + hp + wt, data = mtcars)
                         Model Summary                          
---------------------------------------------------------------
R                       0.909       RMSE                 2.468 
R-Squared               0.827       MSE                  6.964 
Adj. R-Squared          0.808       Coef. Var           13.135 
Pred R-Squared          0.768       AIC                158.643 
MAE                     1.907       SBC                165.972 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                               ANOVA                                 
--------------------------------------------------------------------
                Sum of                                              
               Squares        DF    Mean Square      F         Sig. 
--------------------------------------------------------------------
Regression     931.057         3        310.352    44.566    0.0000 
Residual       194.991        28          6.964                     
Total         1126.047        31                                    
--------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    37.106         2.111                 17.579    0.000    32.782    41.429 
       disp    -0.001         0.010       -0.019    -0.091    0.929    -0.022     0.020 
         hp    -0.031         0.011       -0.354    -2.724    0.011    -0.055    -0.008 
         wt    -3.801         1.066       -0.617    -3.565    0.001    -5.985    -1.617 
----------------------------------------------------------------------------------------
> 
> # if model includes interaction terms set iterm to TRUE
> ols_regress(mpg ~ disp * wt, data = mtcars, iterm = TRUE)
                         Model Summary                          
---------------------------------------------------------------
R                       0.922       RMSE                 2.296 
R-Squared               0.850       MSE                  6.027 
Adj. R-Squared          0.834       Coef. Var           12.219 
Pred R-Squared          0.801       AIC                154.018 
MAE                     1.897       SBC                161.346 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                               ANOVA                                 
--------------------------------------------------------------------
                Sum of                                              
               Squares        DF    Mean Square      F         Sig. 
--------------------------------------------------------------------
Regression     957.299         3        319.100    52.947    0.0000 
Residual       168.749        28          6.027                     
Total         1126.047        31                                    
--------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    44.082         3.123                 14.115    0.000    37.685    50.479 
       disp    -0.056         0.013       -0.385    -4.257    0.000    -0.083    -0.029 
         wt    -6.496         1.313       -0.616    -4.946    0.000    -9.186    -3.805 
    disp:wt     0.012         0.003        0.278     3.596    0.001     0.005     0.018 
----------------------------------------------------------------------------------------
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_sbc")
> ### * ols_sbc
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_sbc
> ### Title: Bayesian information criterion
> ### Aliases: ols_sbc
> 
> ### ** Examples
> 
> # using R computation method
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_sbc(model)
[1] 167.864
> 
> # using STATA computation method
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_sbc(model, method = 'STATA')
[1] 164.3983
> 
> # using SAS computation method
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_sbc(model, method = 'SAS')
[1] 73.58622
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_sbic")
> ### * ols_sbic
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_sbic
> ### Title: Sawa's bayesian information criterion
> ### Aliases: ols_sbic
> 
> ### ** Examples
> 
> full_model <- lm(mpg ~ ., data = mtcars)
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_sbic(model, full_model)
[1] 70.27599
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_all_possible")
> ### * ols_step_all_possible
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_all_possible
> ### Title: All possible regression
> ### Aliases: ols_step_all_possible ols_step_all_possible.default
> ###   plot.ols_step_all_possible
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp, data = mtcars)
> k <- ols_step_all_possible(model)
> k
  Index N Predictors  R-Square Adj. R-Square Mallow's Cp
1     1 1       disp 0.7183433     0.7089548   0.6751205
2     2 1         hp 0.6024373     0.5891853   0.5096958
3     3 2    disp hp 0.7482402     0.7308774   0.6945438
> 
> # plot
> plot(k)
> 
> # maximum subset
> model <- lm(mpg ~ disp + hp + drat + wt + qsec, data = mtcars)
> ols_step_all_possible(model, max_order = 3)
   Index N     Predictors  R-Square Adj. R-Square Mallow's Cp
4      1 1             wt 0.7528328     0.7445939  0.70869536
1      2 1           disp 0.7183433     0.7089548  0.67512054
2      3 1             hp 0.6024373     0.5891853  0.50969578
3      4 1           drat 0.4639952     0.4461283  0.39534988
5      5 1           qsec 0.1752963     0.1478062  0.07541973
11     6 2          hp wt 0.8267855     0.8148396  0.78108710
15     7 2        wt qsec 0.8264161     0.8144448  0.77856272
8      8 2        disp wt 0.7809306     0.7658223  0.72532105
13     9 2        drat wt 0.7608970     0.7444071  0.70444676
6     10 2        disp hp 0.7482402     0.7308774  0.69454380
10    11 2        hp drat 0.7411716     0.7233214  0.67950230
7     12 2      disp drat 0.7310094     0.7124583  0.68078942
9     13 2      disp qsec 0.7215598     0.7023571  0.66395284
12    14 2        hp qsec 0.6368769     0.6118339  0.52014395
14    15 2      drat qsec 0.5921951     0.5640706  0.49351412
25    16 3   drat wt qsec 0.8370214     0.8195594  0.77654413
22    17 3     hp drat wt 0.8368791     0.8194018  0.78162798
24    18 3     hp wt qsec 0.8347678     0.8170643  0.78199548
17    19 3     disp hp wt 0.8268361     0.8082829  0.76789526
21    20 3   disp wt qsec 0.8264170     0.8078189  0.76988533
19    21 3   disp drat wt 0.7835315     0.7603385  0.71107192
16    22 3   disp hp drat 0.7750131     0.7509073  0.71465331
18    23 3   disp hp qsec 0.7541953     0.7278591  0.68301440
23    24 3   hp drat qsec 0.7442512     0.7168495  0.66348166
20    25 3 disp drat qsec 0.7412673     0.7135459  0.67099202
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_all_possible_betas")
> ### * ols_step_all_possible_betas
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_all_possible_betas
> ### Title: All possible regression variable coefficients
> ### Aliases: ols_step_all_possible_betas
> 
> ### ** Examples
> 
> ## Not run: 
> ##D model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> ##D ols_step_all_possible_betas(model)
> ## End(Not run)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_backward_adj_r2")
> ### * ols_step_backward_adj_r2
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_backward_adj_r2
> ### Title: Stepwise Adjusted R-Squared backward regression
> ### Aliases: ols_step_backward_adj_r2 ols_step_backward_adj_r2.default
> ###   plot.ols_step_backward_adj_r2
> 
> ### ** Examples
> 
> # stepwise backward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_backward_adj_r2(model)


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      alc_mod       734.407    752.308    583.884    0.78177    0.74856 
 2      gender        732.494    748.406    581.290    0.78142    0.75351 
 3      age           730.620    744.543    578.844    0.78091    0.75808 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.276 
R-Squared                 0.781       MSE                38202.426 
Adj. R-Squared            0.758       Coef. Var             27.839 
Pred R-Squared            0.700       AIC                  730.620 
MAE                     137.656       SBC                  744.543 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
------------------------------------------------------------------------------------------------

> 
> # final model and selection metrics
> k <- ols_step_backward_aic(model)
> k$metrics
  step variable        r2    adj_r2      aic      sbc     sbic
1    1  alc_mod 0.7817703 0.7485615 734.4068 752.3077 583.8836
2    2   gender 0.7814169 0.7535127 732.4942 748.4061 581.2896
3    3      age 0.7809054 0.7580831 730.6204 744.5433 578.8438
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)          bcs       pindex  enzyme_test   liver_test    alc_heavy  
  -1178.330       59.864        8.924        9.748       58.064      317.848  

> 
> # include or exclude variable
> # force variables to be included in the selection process
> ols_step_backward_adj_r2(model, include = c("alc_mod", "gender"))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      age           734.544    752.445    584.021    0.78121    0.74792 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.147 
R-Squared                 0.781       MSE                39807.322 
Adj. R-Squared            0.748       Coef. Var             28.418 
Pred R-Squared            0.678       AIC                  734.544 
MAE                     136.858       SBC                  752.445 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6538383.716         7     934054.817    23.464    0.0000 
Residual      1831136.821        46      39807.322                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1185.902       217.138                 -5.462    0.000    -1622.977    -748.826 
        bcs       60.545        23.696        0.244     2.555    0.014       12.847     108.242 
     pindex        8.922         1.851        0.379     4.820    0.000        5.196      12.647 
enzyme_test        9.767         1.692        0.522     5.771    0.000        6.360      13.174 
 liver_test       55.301        42.441        0.149     1.303    0.199      -30.129     140.730 
     gender       14.057        57.701        0.018     0.244    0.809     -102.089     130.203 
    alc_mod        4.737        63.812        0.006     0.074    0.941     -123.711     133.184 
  alc_heavy      322.249        84.152        0.318     3.829    0.000      152.859     491.638 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_backward_adj_r2(model, include = c(7, 6))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      age           734.544    752.445    584.021    0.78121    0.74792 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.147 
R-Squared                 0.781       MSE                39807.322 
Adj. R-Squared            0.748       Coef. Var             28.418 
Pred R-Squared            0.678       AIC                  734.544 
MAE                     136.858       SBC                  752.445 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6538383.716         7     934054.817    23.464    0.0000 
Residual      1831136.821        46      39807.322                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1185.902       217.138                 -5.462    0.000    -1622.977    -748.826 
        bcs       60.545        23.696        0.244     2.555    0.014       12.847     108.242 
     pindex        8.922         1.851        0.379     4.820    0.000        5.196      12.647 
enzyme_test        9.767         1.692        0.522     5.771    0.000        6.360      13.174 
 liver_test       55.301        42.441        0.149     1.303    0.199      -30.129     140.730 
     gender       14.057        57.701        0.018     0.244    0.809     -102.089     130.203 
    alc_mod        4.737        63.812        0.006     0.074    0.941     -123.711     133.184 
  alc_heavy      322.249        84.152        0.318     3.829    0.000      152.859     491.638 
------------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_backward_adj_r2(model, exclude = c("alc_heavy", "bcs"))
[1] "No variables have been removed from the model."
> 
> # use index of variable instead of name
> ols_step_backward_adj_r2(model, exclude = c(8, 1))
[1] "No variables have been removed from the model."
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_backward_aic")
> ### * ols_step_backward_aic
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_backward_aic
> ### Title: Stepwise AIC backward regression
> ### Aliases: ols_step_backward_aic ols_step_backward_aic.default
> ###   plot.ols_step_backward_aic
> 
> ### ** Examples
> 
> # stepwise backward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_backward_aic(model)


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      alc_mod       734.407    752.308    583.884    0.78177    0.74856 
 2      gender        732.494    748.406    581.290    0.78142    0.75351 
 3      age           730.620    744.543    578.844    0.78091    0.75808 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.276 
R-Squared                 0.781       MSE                38202.426 
Adj. R-Squared            0.758       Coef. Var             27.839 
Pred R-Squared            0.700       AIC                  730.620 
MAE                     137.656       SBC                  744.543 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
------------------------------------------------------------------------------------------------

> 
> # stepwise backward regression plot
> model <- lm(y ~ ., data = surgical)
> k <- ols_step_backward_aic(model)
> plot(k)
> 
> # selection metrics
> k$metrics
  step variable        r2    adj_r2      aic      sbc     sbic
1    1  alc_mod 0.7817703 0.7485615 734.4068 752.3077 583.8836
2    2   gender 0.7814169 0.7535127 732.4942 748.4061 581.2896
3    3      age 0.7809054 0.7580831 730.6204 744.5433 578.8438
>  
> # final model
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)          bcs       pindex  enzyme_test   liver_test    alc_heavy  
  -1178.330       59.864        8.924        9.748       58.064      317.848  

> 
> # include or exclude variable
> # force variables to be included in the selection process
> ols_step_backward_aic(model, include = c("alc_mod", "gender"))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      age           734.544    752.445    584.021    0.78121    0.74792 
 2      liver_test    734.502    750.413    583.297    0.77314    0.74418 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.879       RMSE                 187.514 
R-Squared                 0.773       MSE                40398.325 
Adj. R-Squared            0.744       Coef. Var             28.628 
Pred R-Squared            0.672       AIC                  734.502 
MAE                     138.127       SBC                  750.413 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6470799.239         6    1078466.540    26.696    0.0000 
Residual      1898721.298        47      40398.325                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1332.543       187.069                 -7.123    0.000    -1708.878    -956.208 
        bcs       80.623        18.135        0.325     4.446    0.000       44.140     117.105 
     pindex       10.000         1.668        0.425     5.995    0.000        6.644      13.355 
enzyme_test       11.116         1.349        0.595     8.243    0.000        8.403      13.829 
     gender       33.509        56.149        0.042     0.597    0.554      -79.448     146.465 
    alc_mod        7.110        64.258        0.009     0.111    0.912     -122.161     136.381 
  alc_heavy      321.131        84.770        0.317     3.788    0.000      150.596     491.666 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_backward_aic(model, include = c(7, 6))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      age           734.544    752.445    584.021    0.78121    0.74792 
 2      liver_test    734.502    750.413    583.297    0.77314    0.74418 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.879       RMSE                 187.514 
R-Squared                 0.773       MSE                40398.325 
Adj. R-Squared            0.744       Coef. Var             28.628 
Pred R-Squared            0.672       AIC                  734.502 
MAE                     138.127       SBC                  750.413 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6470799.239         6    1078466.540    26.696    0.0000 
Residual      1898721.298        47      40398.325                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1332.543       187.069                 -7.123    0.000    -1708.878    -956.208 
        bcs       80.623        18.135        0.325     4.446    0.000       44.140     117.105 
     pindex       10.000         1.668        0.425     5.995    0.000        6.644      13.355 
enzyme_test       11.116         1.349        0.595     8.243    0.000        8.403      13.829 
     gender       33.509        56.149        0.042     0.597    0.554      -79.448     146.465 
    alc_mod        7.110        64.258        0.009     0.111    0.912     -122.161     136.381 
  alc_heavy      321.131        84.770        0.317     3.788    0.000      150.596     491.666 
------------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_backward_aic(model, exclude = c("alc_heavy", "bcs"))
[1] "No variables have been removed from the model."
> 
> # use index of variable instead of name
> ols_step_backward_aic(model, exclude = c(8, 1))
[1] "No variables have been removed from the model."
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_backward_p")
> ### * ols_step_backward_p
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_backward_p
> ### Title: Stepwise backward regression
> ### Aliases: ols_step_backward_p ols_step_backward_p.default
> ###   plot.ols_step_backward_p
> 
> ### ** Examples
> 
> # stepwise backward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_backward_p(model)


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      alc_mod       734.407    752.308    584.276    0.78177    0.74856 
 2      gender        732.494    748.406    581.938    0.78142    0.75351 
 3      age           730.620    744.543    579.638    0.78091    0.75808 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.276 
R-Squared                 0.781       MSE                38202.426 
Adj. R-Squared            0.758       Coef. Var             27.839 
Pred R-Squared            0.700       AIC                  730.620 
MAE                     137.656       SBC                  744.543 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
------------------------------------------------------------------------------------------------

> 
> # stepwise backward regression plot
> model <- lm(y ~ ., data = surgical)
> k <- ols_step_backward_p(model)
> plot(k)
> 
> # selection metrics
> k$metrics
  step variable        r2    adj_r2      aic      sbc     sbic mallows_cp
1    1  alc_mod 0.7817703 0.7485615 734.4068 752.3077 584.2757   7.014100
2    2   gender 0.7814169 0.7535127 732.4942 748.4061 581.9383   5.086996
3    3      age 0.7809054 0.7580831 730.6204 744.5433 579.6377   3.192498
      rmse
1 183.9121
2 184.0610
3 184.2762
> 
> # final model
> k$model

Call:
lm(formula = paste(response, "~", paste(c(include, cterms), collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)          bcs       pindex  enzyme_test   liver_test    alc_heavy  
  -1178.330       59.864        8.924        9.748       58.064      317.848  

> 
> # include or exclude variables
> # force variable to be included in selection process
> ols_step_backward_p(model, include = c("age", "alc_mod"))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      gender        734.478    752.379    584.323    0.78148    0.74823 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.034 
R-Squared                 0.781       MSE                39758.610 
Adj. R-Squared            0.748       Coef. Var             28.400 
Pred R-Squared            0.683       AIC                  734.478 
MAE                     137.950       SBC                  752.379 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6540624.486         7     934374.927    23.501    0.0000 
Residual      1828896.051        46      39758.610                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1145.835       239.628                 -4.782    0.000    -1628.181    -663.488 
        age       -0.889         2.612       -0.025    -0.340    0.735       -6.146       4.369 
    alc_mod        7.490        64.294        0.009     0.116    0.908     -121.927     136.907 
        bcs       61.533        24.019        0.248     2.562    0.014       13.184     109.882 
     pindex        8.961         1.855        0.381     4.832    0.000        5.228      12.694 
enzyme_test        9.864         1.722        0.528     5.729    0.000        6.398      13.330 
 liver_test       53.731        42.828        0.145     1.255    0.216      -32.478     139.939 
  alc_heavy      319.282        84.051        0.315     3.799    0.000      150.096     488.467 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_backward_p(model, include = c(5, 7))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      gender        734.478    752.379    584.323    0.78148    0.74823 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.034 
R-Squared                 0.781       MSE                39758.610 
Adj. R-Squared            0.748       Coef. Var             28.400 
Pred R-Squared            0.683       AIC                  734.478 
MAE                     137.950       SBC                  752.379 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6540624.486         7     934374.927    23.501    0.0000 
Residual      1828896.051        46      39758.610                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1145.835       239.628                 -4.782    0.000    -1628.181    -663.488 
        age       -0.889         2.612       -0.025    -0.340    0.735       -6.146       4.369 
    alc_mod        7.490        64.294        0.009     0.116    0.908     -121.927     136.907 
        bcs       61.533        24.019        0.248     2.562    0.014       13.184     109.882 
     pindex        8.961         1.855        0.381     4.832    0.000        5.228      12.694 
enzyme_test        9.864         1.722        0.528     5.729    0.000        6.398      13.330 
 liver_test       53.731        42.828        0.145     1.255    0.216      -32.478     139.939 
  alc_heavy      319.282        84.051        0.315     3.799    0.000      150.096     488.467 
------------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_backward_p(model, exclude = c("pindex"))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      age           754.624    770.536    598.424    0.67070    0.62866 
 2      gender        752.644    766.566    596.850    0.67058    0.63626 
 3      alc_mod       750.782    762.716    595.377    0.66973    0.64277 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.818       RMSE                 226.248 
R-Squared                 0.670       MSE                56411.635 
Adj. R-Squared            0.643       Coef. Var             33.829 
Pred R-Squared            0.567       AIC                  750.782 
MAE                     171.544       SBC                  762.716 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    5605350.444         4    1401337.611    24.841    0.0000 
Residual      2764170.093        49      56411.635                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                     Parameter Estimates                                       
----------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
----------------------------------------------------------------------------------------------
(Intercept)    -534.711       197.967                 -2.701    0.009    -932.540    -136.882 
        bcs      34.471        27.316        0.139     1.262    0.213     -20.422      89.365 
enzyme_test       7.431         1.929        0.397     3.851    0.000       3.554      11.309 
 liver_test     149.496        43.277        0.403     3.454    0.001      62.528     236.464 
  alc_heavy     292.382        86.822        0.288     3.368    0.001     117.907     466.858 
----------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_backward_p(model, exclude = c(2))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      age           754.624    770.536    598.424    0.67070    0.62866 
 2      gender        752.644    766.566    596.850    0.67058    0.63626 
 3      alc_mod       750.782    762.716    595.377    0.66973    0.64277 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.818       RMSE                 226.248 
R-Squared                 0.670       MSE                56411.635 
Adj. R-Squared            0.643       Coef. Var             33.829 
Pred R-Squared            0.567       AIC                  750.782 
MAE                     171.544       SBC                  762.716 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    5605350.444         4    1401337.611    24.841    0.0000 
Residual      2764170.093        49      56411.635                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                     Parameter Estimates                                       
----------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
----------------------------------------------------------------------------------------------
(Intercept)    -534.711       197.967                 -2.701    0.009    -932.540    -136.882 
        bcs      34.471        27.316        0.139     1.262    0.213     -20.422      89.365 
enzyme_test       7.431         1.929        0.397     3.851    0.000       3.554      11.309 
 liver_test     149.496        43.277        0.403     3.454    0.001      62.528     236.464 
  alc_heavy     292.382        86.822        0.288     3.368    0.001     117.907     466.858 
----------------------------------------------------------------------------------------------

> 
> # hierarchical selection
> model <- lm(y ~ bcs + alc_heavy + pindex + age + alc_mod, data = surgical)
> ols_step_backward_p(model, 0.1, hierarchical = TRUE)


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    782.350    796.273    630.574    0.42896    0.36948 
 1      alc_mod       780.350    792.284    628.324    0.42896    0.38234 
 2      age           778.574    788.519    626.262    0.42659    0.39218 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.653       RMSE                 298.117 
R-Squared                 0.427       MSE                95983.505 
Adj. R-Squared            0.392       Coef. Var             44.127 
Pred R-Squared            0.269       AIC                  778.574 
MAE                     215.068       SBC                  788.519 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    3570345.284         3    1190115.095    12.399    0.0000 
Residual      4799175.253        50      95983.505                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                     Parameter Estimates                                      
---------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
---------------------------------------------------------------------------------------------
(Intercept)    -330.996       216.010                 -1.532    0.132    -764.866    102.874 
        bcs      53.710        27.413        0.217     1.959    0.056      -1.351    108.771 
  alc_heavy     410.115       112.012        0.405     3.661    0.001     185.131    635.098 
     pindex      10.223         2.543        0.435     4.021    0.000       5.116     15.330 
---------------------------------------------------------------------------------------------

> 
> # plot
> k <- ols_step_backward_p(model, 0.1, hierarchical = TRUE)
> plot(k)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_backward_r2")
> ### * ols_step_backward_r2
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_backward_r2
> ### Title: Stepwise R-Squared backward regression
> ### Aliases: ols_step_backward_r2 ols_step_backward_r2.default
> ###   plot.ols_step_backward_r2
> 
> ### ** Examples
> 
> # stepwise backward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_backward_r2(model)
[1] "No variables have been removed from the model."
> 
> # final model and selection metrics
> k <- ols_step_backward_aic(model)
> k$metrics
  step variable        r2    adj_r2      aic      sbc     sbic
1    1  alc_mod 0.7817703 0.7485615 734.4068 752.3077 583.8836
2    2   gender 0.7814169 0.7535127 732.4942 748.4061 581.2896
3    3      age 0.7809054 0.7580831 730.6204 744.5433 578.8438
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)          bcs       pindex  enzyme_test   liver_test    alc_heavy  
  -1178.330       59.864        8.924        9.748       58.064      317.848  

> 
> # include or exclude variable
> # force variables to be included in the selection process
> ols_step_backward_r2(model, include = c("alc_mod", "gender"))
[1] "No variables have been removed from the model."
> 
> # use index of variable instead of name
> ols_step_backward_r2(model, include = c(7, 6))
[1] "No variables have been removed from the model."
> 
> # force variable to be excluded from selection process
> ols_step_backward_r2(model, exclude = c("alc_heavy", "bcs"))
[1] "No variables have been removed from the model."
> 
> # use index of variable instead of name
> ols_step_backward_r2(model, exclude = c(8, 1))
[1] "No variables have been removed from the model."
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_backward_sbc")
> ### * ols_step_backward_sbc
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_backward_sbc
> ### Title: Stepwise SBC backward regression
> ### Aliases: ols_step_backward_sbc ols_step_backward_sbc.default
> ###   plot.ols_step_backward_sbc
> 
> ### ** Examples
> 
> # stepwise backward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_backward_sbc(model)


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      alc_mod       734.407    752.308    583.884    0.78177    0.74856 
 2      gender        732.494    748.406    581.290    0.78142    0.75351 
 3      age           730.620    744.543    578.844    0.78091    0.75808 
 4      liver_test    730.924    742.858    578.678    0.77136    0.75269 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
------------------------------------------------------------------------------------------------

> 
> # stepwise backward regression plot
> model <- lm(y ~ ., data = surgical)
> k <- ols_step_backward_sbc(model)
> plot(k)
> 
> # selection metrics
> k$metrics
  step   variable        r2    adj_r2      aic      sbc     sbic
1    1    alc_mod 0.7817703 0.7485615 734.4068 752.3077 583.8836
2    2     gender 0.7814169 0.7535127 732.4942 748.4061 581.2896
3    3        age 0.7809054 0.7580831 730.6204 744.5433 578.8438
4    4 liver_test 0.7713565 0.7526917 730.9241 742.8580 578.6783
> 
> # final model
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)          bcs       pindex  enzyme_test    alc_heavy  
   -1334.42        81.44        10.13        11.24       312.78  

> 
> # include or exclude variable
> # force variables to be included in the selection process
> ols_step_backward_sbc(model, include = c("alc_mod", "gender"))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      age           734.544    752.445    584.021    0.78121    0.74792 
 2      liver_test    734.502    750.413    583.297    0.77314    0.74418 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.879       RMSE                 187.514 
R-Squared                 0.773       MSE                40398.325 
Adj. R-Squared            0.744       Coef. Var             28.628 
Pred R-Squared            0.672       AIC                  734.502 
MAE                     138.127       SBC                  750.413 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6470799.239         6    1078466.540    26.696    0.0000 
Residual      1898721.298        47      40398.325                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1332.543       187.069                 -7.123    0.000    -1708.878    -956.208 
        bcs       80.623        18.135        0.325     4.446    0.000       44.140     117.105 
     pindex       10.000         1.668        0.425     5.995    0.000        6.644      13.355 
enzyme_test       11.116         1.349        0.595     8.243    0.000        8.403      13.829 
     gender       33.509        56.149        0.042     0.597    0.554      -79.448     146.465 
    alc_mod        7.110        64.258        0.009     0.111    0.912     -122.161     136.381 
  alc_heavy      321.131        84.770        0.317     3.788    0.000      150.596     491.666 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_backward_sbc(model, include = c(7, 6))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      age           734.544    752.445    584.021    0.78121    0.74792 
 2      liver_test    734.502    750.413    583.297    0.77314    0.74418 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.879       RMSE                 187.514 
R-Squared                 0.773       MSE                40398.325 
Adj. R-Squared            0.744       Coef. Var             28.628 
Pred R-Squared            0.672       AIC                  734.502 
MAE                     138.127       SBC                  750.413 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6470799.239         6    1078466.540    26.696    0.0000 
Residual      1898721.298        47      40398.325                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1332.543       187.069                 -7.123    0.000    -1708.878    -956.208 
        bcs       80.623        18.135        0.325     4.446    0.000       44.140     117.105 
     pindex       10.000         1.668        0.425     5.995    0.000        6.644      13.355 
enzyme_test       11.116         1.349        0.595     8.243    0.000        8.403      13.829 
     gender       33.509        56.149        0.042     0.597    0.554      -79.448     146.465 
    alc_mod        7.110        64.258        0.009     0.111    0.912     -122.161     136.381 
  alc_heavy      321.131        84.770        0.317     3.788    0.000      150.596     491.666 
------------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_backward_sbc(model, exclude = c("alc_heavy", "bcs"))
[1] "No variables have been removed from the model."
> 
> # use index of variable instead of name
> ols_step_backward_sbc(model, exclude = c(8, 1))
[1] "No variables have been removed from the model."
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_backward_sbic")
> ### * ols_step_backward_sbic
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_backward_sbic
> ### Title: Stepwise SBIC backward regression
> ### Aliases: ols_step_backward_sbic ols_step_backward_sbic.default
> ###   plot.ols_step_backward_sbic
> 
> ### ** Examples
> 
> # stepwise backward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_backward_sbic(model)


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      alc_mod       734.407    752.308    583.884    0.78177    0.74856 
 2      gender        732.494    748.406    581.290    0.78142    0.75351 
 3      age           730.620    744.543    578.844    0.78091    0.75808 
 4      liver_test    730.924    742.858    578.678    0.77136    0.75269 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
------------------------------------------------------------------------------------------------

> 
> # stepwise backward regression plot
> model <- lm(y ~ ., data = surgical)
> k <- ols_step_backward_sbic(model)
> plot(k)
> 
> # selection metrics
> k$metrics
  step   variable        r2    adj_r2      aic      sbc     sbic
1    1    alc_mod 0.7817703 0.7485615 734.4068 752.3077 583.8836
2    2     gender 0.7814169 0.7535127 732.4942 748.4061 581.2896
3    3        age 0.7809054 0.7580831 730.6204 744.5433 578.8438
4    4 liver_test 0.7713565 0.7526917 730.9241 742.8580 578.6783
> 
> # final model
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)          bcs       pindex  enzyme_test    alc_heavy  
   -1334.42        81.44        10.13        11.24       312.78  

> 
> # include or exclude variable
> # force variables to be included in the selection process
> ols_step_backward_sbic(model, include = c("alc_mod", "gender"))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      age           734.544    752.445    584.021    0.78121    0.74792 
 2      liver_test    734.502    750.413    583.297    0.77314    0.74418 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.879       RMSE                 187.514 
R-Squared                 0.773       MSE                40398.325 
Adj. R-Squared            0.744       Coef. Var             28.628 
Pred R-Squared            0.672       AIC                  734.502 
MAE                     138.127       SBC                  750.413 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6470799.239         6    1078466.540    26.696    0.0000 
Residual      1898721.298        47      40398.325                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1332.543       187.069                 -7.123    0.000    -1708.878    -956.208 
        bcs       80.623        18.135        0.325     4.446    0.000       44.140     117.105 
     pindex       10.000         1.668        0.425     5.995    0.000        6.644      13.355 
enzyme_test       11.116         1.349        0.595     8.243    0.000        8.403      13.829 
     gender       33.509        56.149        0.042     0.597    0.554      -79.448     146.465 
    alc_mod        7.110        64.258        0.009     0.111    0.912     -122.161     136.381 
  alc_heavy      321.131        84.770        0.317     3.788    0.000      150.596     491.666 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_backward_sbic(model, include = c(7, 6))


                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
 1      age           734.544    752.445    584.021    0.78121    0.74792 
 2      liver_test    734.502    750.413    583.297    0.77314    0.74418 
-------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.879       RMSE                 187.514 
R-Squared                 0.773       MSE                40398.325 
Adj. R-Squared            0.744       Coef. Var             28.628 
Pred R-Squared            0.672       AIC                  734.502 
MAE                     138.127       SBC                  750.413 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6470799.239         6    1078466.540    26.696    0.0000 
Residual      1898721.298        47      40398.325                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1332.543       187.069                 -7.123    0.000    -1708.878    -956.208 
        bcs       80.623        18.135        0.325     4.446    0.000       44.140     117.105 
     pindex       10.000         1.668        0.425     5.995    0.000        6.644      13.355 
enzyme_test       11.116         1.349        0.595     8.243    0.000        8.403      13.829 
     gender       33.509        56.149        0.042     0.597    0.554      -79.448     146.465 
    alc_mod        7.110        64.258        0.009     0.111    0.912     -122.161     136.381 
  alc_heavy      321.131        84.770        0.317     3.788    0.000      150.596     491.666 
------------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_backward_sbic(model, exclude = c("alc_heavy", "bcs"))
[1] "No variables have been removed from the model."
> 
> # use index of variable instead of name
> ols_step_backward_sbic(model, exclude = c(8, 1))
[1] "No variables have been removed from the model."
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_best_subset")
> ### * ols_step_best_subset
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_best_subset
> ### Title: Best subsets regression
> ### Aliases: ols_step_best_subset ols_step_best_subset.default
> ###   plot.ols_step_best_subset
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_step_best_subset(model)
   Best Subsets Regression    
------------------------------
Model Index    Predictors
------------------------------
     1         wt              
     2         hp wt           
     3         hp wt qsec      
     4         disp hp wt qsec 
------------------------------

                                                   Subsets Regression Summary                                                    
---------------------------------------------------------------------------------------------------------------------------------
                       Adj.        Pred                                                                                           
Model    R-Square    R-Square    R-Square     C(p)        AIC        SBIC        SBC         MSEP       FPE       HSP       APC  
---------------------------------------------------------------------------------------------------------------------------------
  1        0.7528      0.7446      0.7087    12.4809    166.0294    74.2916    170.4266    296.9167    9.8572    0.3199    0.2801 
  2        0.8268      0.8148      0.7811     2.3690    156.6523    66.5755    162.5153    215.5104    7.3563    0.2402    0.2091 
  3        0.8348      0.8171       0.782     3.0617    157.1426    67.7238    164.4713    213.1929    7.4756    0.2461    0.2124 
  4        0.8351      0.8107       0.771     5.0000    159.0696    70.0408    167.8640    220.8882    7.9497    0.2644    0.2259 
---------------------------------------------------------------------------------------------------------------------------------
AIC: Akaike Information Criteria 
 SBIC: Sawa's Bayesian Information Criteria 
 SBC: Schwarz Bayesian Criteria 
 MSEP: Estimated error of prediction, assuming multivariate normality 
 FPE: Final Prediction Error 
 HSP: Hocking's Sp 
 APC: Amemiya Prediction Criteria 

> ols_step_best_subset(model, metric = "adjr")
   Best Subsets Regression    
------------------------------
Model Index    Predictors
------------------------------
     1         wt              
     2         hp wt           
     3         hp wt qsec      
     4         disp hp wt qsec 
------------------------------

                                                   Subsets Regression Summary                                                    
---------------------------------------------------------------------------------------------------------------------------------
                       Adj.        Pred                                                                                           
Model    R-Square    R-Square    R-Square     C(p)        AIC        SBIC        SBC         MSEP       FPE       HSP       APC  
---------------------------------------------------------------------------------------------------------------------------------
  1        0.7528      0.7446      0.7087    12.4809    166.0294    74.2916    170.4266    296.9167    9.8572    0.3199    0.2801 
  2        0.8268      0.8148      0.7811     2.3690    156.6523    66.5755    162.5153    215.5104    7.3563    0.2402    0.2091 
  3        0.8348      0.8171       0.782     3.0617    157.1426    67.7238    164.4713    213.1929    7.4756    0.2461    0.2124 
  4        0.8351      0.8107       0.771     5.0000    159.0696    70.0408    167.8640    220.8882    7.9497    0.2644    0.2259 
---------------------------------------------------------------------------------------------------------------------------------
AIC: Akaike Information Criteria 
 SBIC: Sawa's Bayesian Information Criteria 
 SBC: Schwarz Bayesian Criteria 
 MSEP: Estimated error of prediction, assuming multivariate normality 
 FPE: Final Prediction Error 
 HSP: Hocking's Sp 
 APC: Amemiya Prediction Criteria 

> ols_step_best_subset(model, metric = "cp")
   Best Subsets Regression    
------------------------------
Model Index    Predictors
------------------------------
     1         wt              
     2         hp wt           
     3         hp wt qsec      
     4         disp hp wt qsec 
------------------------------

                                                   Subsets Regression Summary                                                    
---------------------------------------------------------------------------------------------------------------------------------
                       Adj.        Pred                                                                                           
Model    R-Square    R-Square    R-Square     C(p)        AIC        SBIC        SBC         MSEP       FPE       HSP       APC  
---------------------------------------------------------------------------------------------------------------------------------
  1        0.7528      0.7446      0.7087    12.4809    166.0294    74.2916    170.4266    296.9167    9.8572    0.3199    0.2801 
  2        0.8268      0.8148      0.7811     2.3690    156.6523    66.5755    162.5153    215.5104    7.3563    0.2402    0.2091 
  3        0.8348      0.8171       0.782     3.0617    157.1426    67.7238    164.4713    213.1929    7.4756    0.2461    0.2124 
  4        0.8351      0.8107       0.771     5.0000    159.0696    70.0408    167.8640    220.8882    7.9497    0.2644    0.2259 
---------------------------------------------------------------------------------------------------------------------------------
AIC: Akaike Information Criteria 
 SBIC: Sawa's Bayesian Information Criteria 
 SBC: Schwarz Bayesian Criteria 
 MSEP: Estimated error of prediction, assuming multivariate normality 
 FPE: Final Prediction Error 
 HSP: Hocking's Sp 
 APC: Amemiya Prediction Criteria 

> 
> # maximum subset
> model <- lm(mpg ~ disp + hp + drat + wt + qsec, data = mtcars)
> ols_step_best_subset(model, max_order = 3)
  Best Subsets Regression  
---------------------------
Model Index    Predictors
---------------------------
     1         wt           
     2         hp wt        
     3         drat wt qsec 
---------------------------

                                                   Subsets Regression Summary                                                    
---------------------------------------------------------------------------------------------------------------------------------
                       Adj.        Pred                                                                                           
Model    R-Square    R-Square    R-Square     C(p)        AIC        SBIC        SBC         MSEP       FPE       HSP       APC  
---------------------------------------------------------------------------------------------------------------------------------
  1        0.7528      0.7446      0.7087    14.5346    166.0294    74.1040    170.4266    296.9167    9.8572    0.3199    0.2801 
  2        0.8268      0.8148      0.7811     3.8082    156.6523    66.2706    162.5153    215.5104    7.3563    0.2402    0.2091 
  3        0.8370      0.8196      0.7765     4.0467    156.7031    66.9790    164.0318    210.2851    7.3736    0.2428    0.2095 
---------------------------------------------------------------------------------------------------------------------------------
AIC: Akaike Information Criteria 
 SBIC: Sawa's Bayesian Information Criteria 
 SBC: Schwarz Bayesian Criteria 
 MSEP: Estimated error of prediction, assuming multivariate normality 
 FPE: Final Prediction Error 
 HSP: Hocking's Sp 
 APC: Amemiya Prediction Criteria 

> 
> # plot
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> k <- ols_step_best_subset(model)
> plot(k)
> 
> # return only models including `qsec`
> ols_step_best_subset(model, include = c("qsec"))
   Best Subsets Regression    
------------------------------
Model Index    Predictors
------------------------------
     1         qsec            
     2         wt qsec         
     3         hp wt qsec      
     4         disp hp wt qsec 
------------------------------

                                                     Subsets Regression Summary                                                     
------------------------------------------------------------------------------------------------------------------------------------
                       Adj.        Pred                                                                                              
Model    R-Square    R-Square    R-Square      C(p)        AIC         SBIC        SBC         MSEP        FPE       HSP       APC  
------------------------------------------------------------------------------------------------------------------------------------
  1        0.1753      0.1478      0.0754    107.0696    204.5881    109.5591    208.9853    990.6990    32.8899    1.0674    0.9347 
  2        0.8264      0.8144      0.7786      2.4295    156.7205     66.6304    162.5834    215.9699     7.3720    0.2407    0.2095 
  3        0.8348      0.8171       0.782      3.0617    157.1426     67.7238    164.4713    213.1929     7.4756    0.2461    0.2124 
  4        0.8351      0.8107       0.771      5.0000    159.0696     70.0408    167.8640    220.8882     7.9497    0.2644    0.2259 
------------------------------------------------------------------------------------------------------------------------------------
AIC: Akaike Information Criteria 
 SBIC: Sawa's Bayesian Information Criteria 
 SBC: Schwarz Bayesian Criteria 
 MSEP: Estimated error of prediction, assuming multivariate normality 
 FPE: Final Prediction Error 
 HSP: Hocking's Sp 
 APC: Amemiya Prediction Criteria 

> 
> # exclude `hp` from selection process
> ols_step_best_subset(model, exclude = c("hp"))
  Best Subsets Regression  
---------------------------
Model Index    Predictors
---------------------------
     1         wt           
     2         wt qsec      
     3         disp wt qsec 
---------------------------

                                                   Subsets Regression Summary                                                    
---------------------------------------------------------------------------------------------------------------------------------
                       Adj.        Pred                                                                                           
Model    R-Square    R-Square    R-Square     C(p)        AIC        SBIC        SBC         MSEP       FPE       HSP       APC  
---------------------------------------------------------------------------------------------------------------------------------
  1        0.7528      0.7446      0.7087    12.4809    166.0294    74.2916    170.4266    296.9167    9.8572    0.3199    0.2801 
  2        0.8264      0.8144      0.7786     2.4295    156.7205    66.6304    162.5834    215.9699    7.3720    0.2407    0.2095 
  3        0.8264      0.8078      0.7699     4.4293    158.7203    68.8815    166.0490    223.9676    7.8534    0.2585    0.2232 
---------------------------------------------------------------------------------------------------------------------------------
AIC: Akaike Information Criteria 
 SBIC: Sawa's Bayesian Information Criteria 
 SBC: Schwarz Bayesian Criteria 
 MSEP: Estimated error of prediction, assuming multivariate normality 
 FPE: Final Prediction Error 
 HSP: Hocking's Sp 
 APC: Amemiya Prediction Criteria 

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_both_adj_r2")
> ### * ols_step_both_adj_r2
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_both_adj_r2
> ### Title: Stepwise Adjusted R-Squared regression
> ### Aliases: ols_step_both_adj_r2 ols_step_both_adj_r2.default
> ###   plot.ols_step_both_adj_r2
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # stepwise regression
> ##D model <- lm(y ~ ., data = stepdata)
> ##D ols_step_both_adj_r2(model)
> ##D 
> ##D # stepwise regression plot
> ##D model <- lm(y ~ ., data = stepdata)
> ##D k <- ols_step_both_adj_r2(model)
> ##D plot(k)
> ##D 
> ##D # selection metrics
> ##D k$metrics
> ##D 
> ##D # final model
> ##D k$model
> ##D 
> ##D # include or exclude variables
> ##D # force variable to be included in selection process
> ##D model <- lm(y ~ ., data = stepdata)
> ##D 
> ##D ols_step_both_adj_r2(model, include = c("x6"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_adj_r2(model, include = c(6))
> ##D 
> ##D # force variable to be excluded from selection process
> ##D ols_step_both_adj_r2(model, exclude = c("x2"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_adj_r2(model, exclude = c(2))
> ##D 
> ##D # include & exclude variables in the selection process
> ##D ols_step_both_adj_r2(model, include = c("x6"), exclude = c("x2"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_adj_r2(model, include = c(6), exclude = c(2))
> ## End(Not run)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_both_aic")
> ### * ols_step_both_aic
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_both_aic
> ### Title: Stepwise AIC regression
> ### Aliases: ols_step_both_aic ols_step_both_aic.default
> ###   plot.ols_step_both_aic
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # stepwise regression
> ##D model <- lm(y ~ ., data = stepdata)
> ##D ols_step_both_aic(model)
> ##D 
> ##D # stepwise regression plot
> ##D model <- lm(y ~ ., data = stepdata)
> ##D k <- ols_step_both_aic(model)
> ##D plot(k)
> ##D 
> ##D # selection metrics
> ##D k$metrics
> ##D 
> ##D # final model
> ##D k$model
> ##D 
> ##D # include or exclude variables
> ##D # force variable to be included in selection process
> ##D model <- lm(y ~ ., data = stepdata)
> ##D 
> ##D ols_step_both_aic(model, include = c("x6"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_aic(model, include = c(6))
> ##D 
> ##D # force variable to be excluded from selection process
> ##D ols_step_both_aic(model, exclude = c("x2"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_aic(model, exclude = c(2))
> ##D 
> ##D # include & exclude variables in the selection process
> ##D ols_step_both_aic(model, include = c("x6"), exclude = c("x2"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_aic(model, include = c(6), exclude = c(2))
> ## End(Not run)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_both_p")
> ### * ols_step_both_p
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_both_p
> ### Title: Stepwise regression
> ### Aliases: ols_step_both_p ols_step_both_p.default plot.ols_step_both_p
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # stepwise regression
> ##D model <- lm(y ~ ., data = surgical)
> ##D ols_step_both_p(model)
> ##D 
> ##D # stepwise regression plot
> ##D model <- lm(y ~ ., data = surgical)
> ##D k <- ols_step_both_p(model)
> ##D plot(k)
> ##D 
> ##D # selection metrics
> ##D k$metrics
> ##D 
> ##D # final model
> ##D k$model
> ##D 
> ##D # include or exclude variables
> ##D model <- lm(y ~ ., data = stepdata)
> ##D 
> ##D # force variable to be included in selection process
> ##D ols_step_both_p(model, include = c("x6"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_p(model, include = c(6))
> ##D 
> ##D # force variable to be excluded from selection process
> ##D ols_step_both_p(model, exclude = c("x1"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_p(model, exclude = c(1))
> ## End(Not run)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_both_r2")
> ### * ols_step_both_r2
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_both_r2
> ### Title: Stepwise R-Squared regression
> ### Aliases: ols_step_both_r2 ols_step_both_r2.default
> ###   plot.ols_step_both_r2
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # stepwise regression
> ##D model <- lm(y ~ ., data = stepdata)
> ##D ols_step_both_r2(model)
> ##D 
> ##D # stepwise regression plot
> ##D model <- lm(y ~ ., data = stepdata)
> ##D k <- ols_step_both_r2(model)
> ##D plot(k)
> ##D 
> ##D # selection metrics
> ##D k$metrics
> ##D 
> ##D # final model
> ##D k$model
> ##D 
> ##D # include or exclude variables
> ##D # force variable to be included in selection process
> ##D model <- lm(y ~ ., data = stepdata)
> ##D 
> ##D ols_step_both_r2(model, include = c("x6"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_r2(model, include = c(6))
> ##D 
> ##D # force variable to be excluded from selection process
> ##D ols_step_both_r2(model, exclude = c("x2"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_r2(model, exclude = c(2))
> ##D 
> ##D # include & exclude variables in the selection process
> ##D ols_step_both_r2(model, include = c("x6"), exclude = c("x2"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_r2(model, include = c(6), exclude = c(2))
> ## End(Not run)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_both_sbc")
> ### * ols_step_both_sbc
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_both_sbc
> ### Title: Stepwise SBC regression
> ### Aliases: ols_step_both_sbc ols_step_both_sbc.default
> ###   plot.ols_step_both_sbc
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # stepwise regression
> ##D model <- lm(y ~ ., data = stepdata)
> ##D ols_step_both_sbc(model)
> ##D 
> ##D # stepwise regression plot
> ##D model <- lm(y ~ ., data = stepdata)
> ##D k <- ols_step_both_sbc(model)
> ##D plot(k)
> ##D 
> ##D # selection metrics
> ##D k$metrics
> ##D 
> ##D # final model
> ##D k$model
> ##D 
> ##D # include or exclude variables
> ##D # force variable to be included in selection process
> ##D model <- lm(y ~ ., data = stepdata)
> ##D 
> ##D ols_step_both_sbc(model, include = c("x6"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_sbc(model, include = c(6))
> ##D 
> ##D # force variable to be excluded from selection process
> ##D ols_step_both_sbc(model, exclude = c("x2"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_sbc(model, exclude = c(2))
> ##D 
> ##D # include & exclude variables in the selection process
> ##D ols_step_both_sbc(model, include = c("x6"), exclude = c("x2"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_sbc(model, include = c(6), exclude = c(2))
> ## End(Not run)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_both_sbic")
> ### * ols_step_both_sbic
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_both_sbic
> ### Title: Stepwise SBIC regression
> ### Aliases: ols_step_both_sbic ols_step_both_sbic.default
> ###   plot.ols_step_both_sbic
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # stepwise regression
> ##D model <- lm(y ~ ., data = stepdata)
> ##D ols_step_both_sbic(model)
> ##D 
> ##D # stepwise regression plot
> ##D model <- lm(y ~ ., data = stepdata)
> ##D k <- ols_step_both_sbic(model)
> ##D plot(k)
> ##D 
> ##D # selection metrics
> ##D k$metrics
> ##D 
> ##D # final model
> ##D k$model
> ##D 
> ##D # include or exclude variables
> ##D # force variable to be included in selection process
> ##D model <- lm(y ~ ., data = stepdata)
> ##D 
> ##D ols_step_both_sbic(model, include = c("x6"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_sbic(model, include = c(6))
> ##D 
> ##D # force variable to be excluded from selection process
> ##D ols_step_both_sbic(model, exclude = c("x2"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_sbic(model, exclude = c(2))
> ##D 
> ##D # include & exclude variables in the selection process
> ##D ols_step_both_sbic(model, include = c("x6"), exclude = c("x2"))
> ##D 
> ##D # use index of variable instead of name
> ##D ols_step_both_sbic(model, include = c(6), exclude = c(2))
> ## End(Not run)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_forward_adj_r2")
> ### * ols_step_forward_adj_r2
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_forward_adj_r2
> ### Title: Stepwise Adjusted R-Squared forward regression
> ### Aliases: ols_step_forward_adj_r2 ols_step_forward_adj_r2.default
> ###   plot.ols_step_forward_adj_r2
> 
> ### ** Examples
> 
> # stepwise forward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_forward_adj_r2(model)


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      liver_test     771.875    777.842    616.009    0.45454    0.44405 
 2      alc_heavy      761.439    769.395    605.506    0.56674    0.54975 
 3      enzyme_test    750.509    760.454    595.297    0.65900    0.63854 
 4      pindex         735.715    747.649    582.943    0.75015    0.72975 
 5      bcs            730.620    744.543    579.638    0.78091    0.75808 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.276 
R-Squared                 0.781       MSE                38202.426 
Adj. R-Squared            0.758       Coef. Var             27.839 
Pred R-Squared            0.700       AIC                  730.620 
MAE                     137.656       SBC                  744.543 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------

> 
> # stepwise forward regression plot
> k <- ols_step_forward_adj_r2(model)
> plot(k)
> 
> # selection metrics
> k$metrics
  step    variable        r2    adj_r2      aic      sbc     sbic
1    1  liver_test 0.4545389 0.4440492 771.8753 777.8423 616.0089
2    2   alc_heavy 0.5667409 0.5497504 761.4394 769.3953 605.5062
3    3 enzyme_test 0.6590000 0.6385400 750.5089 760.4538 595.2974
4    4      pindex 0.7501457 0.7297495 735.7146 747.6485 582.9426
5    5         bcs 0.7809054 0.7580831 730.6204 744.5433 579.6377
> 
> # extract final model
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)   liver_test    alc_heavy  enzyme_test       pindex          bcs  
  -1178.330       58.064      317.848        9.748        8.924       59.864  

> 
> # include or exclude variables
> # force variable to be included in selection process
> ols_step_forward_adj_r2(model, include = c("age"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      liver_test     773.831    781.787    616.928    0.45498     0.43361 
 2      alc_heavy      763.110    773.055    606.421    0.56938     0.54354 
 3      enzyme_test    752.416    764.350    596.755    0.65959     0.63180 
 4      pindex         737.680    751.603    585.012    0.75030     0.72429 
 5      bcs            732.494    748.406    581.938    0.78142     0.75351 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.061 
R-Squared                 0.781       MSE                38924.162 
Adj. R-Squared            0.754       Coef. Var             28.101 
Pred R-Squared            0.692       AIC                  732.494 
MAE                     138.160       SBC                  748.406 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6540084.920         6    1090014.153    28.004    0.0000 
Residual      1829435.617        47      38924.162                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1143.080       235.943                 -4.845    0.000    -1617.737    -668.424 
        age       -0.850         2.563       -0.024    -0.332    0.742       -6.007       4.307 
 liver_test       54.053        42.288        0.146     1.278    0.207      -31.019     139.125 
  alc_heavy      314.585        72.974        0.310     4.311    0.000      167.781     461.390 
enzyme_test        9.852         1.700        0.527     5.794    0.000        6.431      13.273 
     pindex        8.974         1.832        0.382     4.900    0.000        5.290      12.659 
        bcs       61.424        23.748        0.248     2.586    0.013       13.649     109.199 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_adj_r2(model, include = c(5))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      liver_test     773.831    781.787    616.928    0.45498     0.43361 
 2      alc_heavy      763.110    773.055    606.421    0.56938     0.54354 
 3      enzyme_test    752.416    764.350    596.755    0.65959     0.63180 
 4      pindex         737.680    751.603    585.012    0.75030     0.72429 
 5      bcs            732.494    748.406    581.938    0.78142     0.75351 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.061 
R-Squared                 0.781       MSE                38924.162 
Adj. R-Squared            0.754       Coef. Var             28.101 
Pred R-Squared            0.692       AIC                  732.494 
MAE                     138.160       SBC                  748.406 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6540084.920         6    1090014.153    28.004    0.0000 
Residual      1829435.617        47      38924.162                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1143.080       235.943                 -4.845    0.000    -1617.737    -668.424 
        age       -0.850         2.563       -0.024    -0.332    0.742       -6.007       4.307 
 liver_test       54.053        42.288        0.146     1.278    0.207      -31.019     139.125 
  alc_heavy      314.585        72.974        0.310     4.311    0.000      167.781     461.390 
enzyme_test        9.852         1.700        0.527     5.794    0.000        6.431      13.273 
     pindex        8.974         1.832        0.382     4.900    0.000        5.290      12.659 
        bcs       61.424        23.748        0.248     2.586    0.013       13.649     109.199 
------------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_forward_adj_r2(model, exclude = c("liver_test"))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      enzyme_test    782.629    788.596    626.220    0.33435    0.32154 
 2      bcs            766.271    774.226    609.940    0.52619    0.50761 
 3      pindex         746.376    756.320    591.702    0.68413    0.66518 
 4      alc_heavy      730.924    742.858    579.087    0.77136    0.75269 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_adj_r2(model, exclude = c(4))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      enzyme_test    782.629    788.596    626.220    0.33435    0.32154 
 2      bcs            766.271    774.226    609.940    0.52619    0.50761 
 3      pindex         746.376    756.320    591.702    0.68413    0.66518 
 4      alc_heavy      730.924    742.858    579.087    0.77136    0.75269 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
------------------------------------------------------------------------------------------------

> 
> # include & exclude variables in the selection process
> ols_step_forward_adj_r2(model, include = c("age"), exclude = c("liver_test"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      enzyme_test    783.607    791.563    626.048    0.34683     0.32121 
 2      bcs            767.078    777.023    609.973    0.53654     0.50873 
 3      pindex         747.171    759.105    592.354    0.69109     0.66588 
 4      alc_heavy      732.339    746.262    580.934    0.77382     0.75026 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.880       RMSE                 187.233 
R-Squared                 0.774       MSE                39438.163 
Adj. R-Squared            0.750       Coef. Var             28.286 
Pred R-Squared            0.688       AIC                  732.339 
MAE                     140.528       SBC                  746.262 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6476488.730         5    1295297.746    32.844    0.0000 
Residual      1893031.807        48      39438.163                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1237.653       225.517                 -5.488    0.000    -1691.085    -784.221 
        age       -1.787         2.473       -0.050    -0.723    0.473       -6.759       3.184 
enzyme_test       11.244         1.314        0.601     8.555    0.000        8.601      13.887 
        bcs       81.587        17.870        0.329     4.566    0.000       45.657     117.516 
     pindex       10.062         1.633        0.428     6.163    0.000        6.779      13.344 
  alc_heavy      306.655        73.188        0.303     4.190    0.000      159.500     453.809 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_adj_r2(model, include = c(5), exclude = c(4))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      enzyme_test    783.607    791.563    626.048    0.34683     0.32121 
 2      bcs            767.078    777.023    609.973    0.53654     0.50873 
 3      pindex         747.171    759.105    592.354    0.69109     0.66588 
 4      alc_heavy      732.339    746.262    580.934    0.77382     0.75026 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.880       RMSE                 187.233 
R-Squared                 0.774       MSE                39438.163 
Adj. R-Squared            0.750       Coef. Var             28.286 
Pred R-Squared            0.688       AIC                  732.339 
MAE                     140.528       SBC                  746.262 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6476488.730         5    1295297.746    32.844    0.0000 
Residual      1893031.807        48      39438.163                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1237.653       225.517                 -5.488    0.000    -1691.085    -784.221 
        age       -1.787         2.473       -0.050    -0.723    0.473       -6.759       3.184 
enzyme_test       11.244         1.314        0.601     8.555    0.000        8.601      13.887 
        bcs       81.587        17.870        0.329     4.566    0.000       45.657     117.516 
     pindex       10.062         1.633        0.428     6.163    0.000        6.779      13.344 
  alc_heavy      306.655        73.188        0.303     4.190    0.000      159.500     453.809 
------------------------------------------------------------------------------------------------

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_forward_aic")
> ### * ols_step_forward_aic
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_forward_aic
> ### Title: Stepwise AIC forward regression
> ### Aliases: ols_step_forward_aic ols_step_forward_aic.default
> ###   plot.ols_step_forward_aic
> 
> ### ** Examples
> 
> # stepwise forward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_forward_aic(model)


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      liver_test     771.875    777.842    616.009    0.45454    0.44405 
 2      alc_heavy      761.439    769.395    605.506    0.56674    0.54975 
 3      enzyme_test    750.509    760.454    595.297    0.65900    0.63854 
 4      pindex         735.715    747.649    582.943    0.75015    0.72975 
 5      bcs            730.620    744.543    579.638    0.78091    0.75808 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.276 
R-Squared                 0.781       MSE                38202.426 
Adj. R-Squared            0.758       Coef. Var             27.839 
Pred R-Squared            0.700       AIC                  730.620 
MAE                     137.656       SBC                  744.543 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------

> 
> # stepwise forward regression plot
> k <- ols_step_forward_aic(model)
> plot(k)
> 
> # selection metrics
> k$metrics
  step    variable        r2    adj_r2      aic      sbc     sbic
1    1  liver_test 0.4545389 0.4440492 771.8753 777.8423 616.0089
2    2   alc_heavy 0.5667409 0.5497504 761.4394 769.3953 605.5062
3    3 enzyme_test 0.6590000 0.6385400 750.5089 760.4538 595.2974
4    4      pindex 0.7501457 0.7297495 735.7146 747.6485 582.9426
5    5         bcs 0.7809054 0.7580831 730.6204 744.5433 579.6377
> 
> # extract final model
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)   liver_test    alc_heavy  enzyme_test       pindex          bcs  
  -1178.330       58.064      317.848        9.748        8.924       59.864  

> 
> # include or exclude variables
> # force variable to be included in selection process
> ols_step_forward_aic(model, include = c("age"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      liver_test     773.831    781.787    616.928    0.45498     0.43361 
 2      alc_heavy      763.110    773.055    606.421    0.56938     0.54354 
 3      enzyme_test    752.416    764.350    596.755    0.65959     0.63180 
 4      pindex         737.680    751.603    585.012    0.75030     0.72429 
 5      bcs            732.494    748.406    581.938    0.78142     0.75351 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.061 
R-Squared                 0.781       MSE                38924.162 
Adj. R-Squared            0.754       Coef. Var             28.101 
Pred R-Squared            0.692       AIC                  732.494 
MAE                     138.160       SBC                  748.406 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6540084.920         6    1090014.153    28.004    0.0000 
Residual      1829435.617        47      38924.162                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1143.080       235.943                 -4.845    0.000    -1617.737    -668.424 
        age       -0.850         2.563       -0.024    -0.332    0.742       -6.007       4.307 
 liver_test       54.053        42.288        0.146     1.278    0.207      -31.019     139.125 
  alc_heavy      314.585        72.974        0.310     4.311    0.000      167.781     461.390 
enzyme_test        9.852         1.700        0.527     5.794    0.000        6.431      13.273 
     pindex        8.974         1.832        0.382     4.900    0.000        5.290      12.659 
        bcs       61.424        23.748        0.248     2.586    0.013       13.649     109.199 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_aic(model, include = c(5))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      liver_test     773.831    781.787    616.928    0.45498     0.43361 
 2      alc_heavy      763.110    773.055    606.421    0.56938     0.54354 
 3      enzyme_test    752.416    764.350    596.755    0.65959     0.63180 
 4      pindex         737.680    751.603    585.012    0.75030     0.72429 
 5      bcs            732.494    748.406    581.938    0.78142     0.75351 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.061 
R-Squared                 0.781       MSE                38924.162 
Adj. R-Squared            0.754       Coef. Var             28.101 
Pred R-Squared            0.692       AIC                  732.494 
MAE                     138.160       SBC                  748.406 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6540084.920         6    1090014.153    28.004    0.0000 
Residual      1829435.617        47      38924.162                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1143.080       235.943                 -4.845    0.000    -1617.737    -668.424 
        age       -0.850         2.563       -0.024    -0.332    0.742       -6.007       4.307 
 liver_test       54.053        42.288        0.146     1.278    0.207      -31.019     139.125 
  alc_heavy      314.585        72.974        0.310     4.311    0.000      167.781     461.390 
enzyme_test        9.852         1.700        0.527     5.794    0.000        6.431      13.273 
     pindex        8.974         1.832        0.382     4.900    0.000        5.290      12.659 
        bcs       61.424        23.748        0.248     2.586    0.013       13.649     109.199 
------------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_forward_aic(model, exclude = c("liver_test"))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      enzyme_test    782.629    788.596    626.220    0.33435    0.32154 
 2      bcs            766.271    774.226    609.940    0.52619    0.50761 
 3      pindex         746.376    756.320    591.702    0.68413    0.66518 
 4      alc_heavy      730.924    742.858    579.087    0.77136    0.75269 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_aic(model, exclude = c(4))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      enzyme_test    782.629    788.596    626.220    0.33435    0.32154 
 2      bcs            766.271    774.226    609.940    0.52619    0.50761 
 3      pindex         746.376    756.320    591.702    0.68413    0.66518 
 4      alc_heavy      730.924    742.858    579.087    0.77136    0.75269 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
------------------------------------------------------------------------------------------------

> 
> # include & exclude variables in the selection process
> ols_step_forward_aic(model, include = c("age"), exclude = c("liver_test"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      enzyme_test    783.607    791.563    626.048    0.34683     0.32121 
 2      bcs            767.078    777.023    609.973    0.53654     0.50873 
 3      pindex         747.171    759.105    592.354    0.69109     0.66588 
 4      alc_heavy      732.339    746.262    580.934    0.77382     0.75026 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.880       RMSE                 187.233 
R-Squared                 0.774       MSE                39438.163 
Adj. R-Squared            0.750       Coef. Var             28.286 
Pred R-Squared            0.688       AIC                  732.339 
MAE                     140.528       SBC                  746.262 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6476488.730         5    1295297.746    32.844    0.0000 
Residual      1893031.807        48      39438.163                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1237.653       225.517                 -5.488    0.000    -1691.085    -784.221 
        age       -1.787         2.473       -0.050    -0.723    0.473       -6.759       3.184 
enzyme_test       11.244         1.314        0.601     8.555    0.000        8.601      13.887 
        bcs       81.587        17.870        0.329     4.566    0.000       45.657     117.516 
     pindex       10.062         1.633        0.428     6.163    0.000        6.779      13.344 
  alc_heavy      306.655        73.188        0.303     4.190    0.000      159.500     453.809 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_aic(model, include = c(5), exclude = c(4))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      enzyme_test    783.607    791.563    626.048    0.34683     0.32121 
 2      bcs            767.078    777.023    609.973    0.53654     0.50873 
 3      pindex         747.171    759.105    592.354    0.69109     0.66588 
 4      alc_heavy      732.339    746.262    580.934    0.77382     0.75026 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.880       RMSE                 187.233 
R-Squared                 0.774       MSE                39438.163 
Adj. R-Squared            0.750       Coef. Var             28.286 
Pred R-Squared            0.688       AIC                  732.339 
MAE                     140.528       SBC                  746.262 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6476488.730         5    1295297.746    32.844    0.0000 
Residual      1893031.807        48      39438.163                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1237.653       225.517                 -5.488    0.000    -1691.085    -784.221 
        age       -1.787         2.473       -0.050    -0.723    0.473       -6.759       3.184 
enzyme_test       11.244         1.314        0.601     8.555    0.000        8.601      13.887 
        bcs       81.587        17.870        0.329     4.566    0.000       45.657     117.516 
     pindex       10.062         1.633        0.428     6.163    0.000        6.779      13.344 
  alc_heavy      306.655        73.188        0.303     4.190    0.000      159.500     453.809 
------------------------------------------------------------------------------------------------

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_forward_p")
> ### * ols_step_forward_p
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_forward_p
> ### Title: Stepwise forward regression
> ### Aliases: ols_step_forward_p ols_step_forward_p.default
> ###   plot.ols_step_forward_p
> 
> ### ** Examples
> 
> # stepwise forward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_forward_p(model)


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      liver_test     771.875    777.842    616.009    0.45454    0.44405 
 2      alc_heavy      761.439    769.395    605.506    0.56674    0.54975 
 3      enzyme_test    750.509    760.454    595.297    0.65900    0.63854 
 4      pindex         735.715    747.649    582.943    0.75015    0.72975 
 5      bcs            730.620    744.543    579.638    0.78091    0.75808 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.276 
R-Squared                 0.781       MSE                38202.426 
Adj. R-Squared            0.758       Coef. Var             27.839 
Pred R-Squared            0.700       AIC                  730.620 
MAE                     137.656       SBC                  744.543 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------

> 
> # stepwise forward regression plot
> model <- lm(y ~ ., data = surgical)
> k <- ols_step_forward_p(model)
> plot(k)
> 
> # selection metrics
> k$metrics
  step    variable        r2    adj_r2      aic      sbc     sbic mallows_cp
1    1  liver_test 0.4545389 0.4440492 771.8753 777.8423 616.0089  62.511923
2    2   alc_heavy 0.5667409 0.5497504 761.4394 769.3953 605.5062  41.368078
3    3 enzyme_test 0.6590000 0.6385400 750.5089 760.4538 595.2974  24.337853
4    4      pindex 0.7501457 0.7297495 735.7146 747.6485 582.9426   7.537284
5    5         bcs 0.7809054 0.7580831 730.6204 744.5433 579.6377   3.192498
      rmse
1 290.7604
2 259.1357
3 229.8956
4 196.7872
5 184.2762
> 
> # final model
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)   liver_test    alc_heavy  enzyme_test       pindex          bcs  
  -1178.330       58.064      317.848        9.748        8.924       59.864  

> 
> # include or exclude variables
> # force variable to be included in selection process
> ols_step_forward_p(model, include = c("age", "alc_mod"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     804.340    812.295    645.675    0.04110     0.00350 
 1      age            803.834    809.801    646.572    0.01420    -0.00476 
 2      alc_mod        804.340    812.295    645.675    0.04110     0.00350 
 3      liver_test     772.922    782.867    615.246    0.48357     0.45258 
 4      enzyme_test    763.665    775.599    606.382    0.58074     0.54652 
 5      alc_heavy      754.332    768.255    598.224    0.66012     0.62471 
 6      pindex         739.680    755.592    587.108    0.75031     0.71843 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.866       RMSE                 196.724 
R-Squared                 0.750       MSE                44464.323 
Adj. R-Squared            0.718       Coef. Var             30.034 
Pred R-Squared            0.649       AIC                  739.680 
MAE                     146.418       SBC                  755.592 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6279697.346         6    1046616.224    23.538    0.0000 
Residual      2089823.191        47      44464.323                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                       
-----------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
-----------------------------------------------------------------------------------------------
(Intercept)    -814.092       213.222                 -3.818    0.000    -1243.041    -385.144 
        age       0.458         2.706        0.013     0.169    0.866       -4.985       5.902 
    alc_mod       1.088        67.941        0.001     0.016    0.987     -135.591     137.768 
 liver_test     126.675        33.832        0.341     3.744    0.000       58.613     194.737 
enzyme_test       7.523         1.543        0.402     4.874    0.000        4.418      10.628 
  alc_heavy     361.751        87.140        0.357     4.151    0.000      186.448     537.053 
     pindex       7.862         1.908        0.334     4.120    0.000        4.023      11.700 
-----------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_p(model, include = c(5, 7))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     804.340    812.295    645.675    0.04110     0.00350 
 1      age            803.834    809.801    646.572    0.01420    -0.00476 
 2      alc_mod        804.340    812.295    645.675    0.04110     0.00350 
 3      liver_test     772.922    782.867    615.246    0.48357     0.45258 
 4      enzyme_test    763.665    775.599    606.382    0.58074     0.54652 
 5      alc_heavy      754.332    768.255    598.224    0.66012     0.62471 
 6      pindex         739.680    755.592    587.108    0.75031     0.71843 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.866       RMSE                 196.724 
R-Squared                 0.750       MSE                44464.323 
Adj. R-Squared            0.718       Coef. Var             30.034 
Pred R-Squared            0.649       AIC                  739.680 
MAE                     146.418       SBC                  755.592 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6279697.346         6    1046616.224    23.538    0.0000 
Residual      2089823.191        47      44464.323                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                       
-----------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
-----------------------------------------------------------------------------------------------
(Intercept)    -814.092       213.222                 -3.818    0.000    -1243.041    -385.144 
        age       0.458         2.706        0.013     0.169    0.866       -4.985       5.902 
    alc_mod       1.088        67.941        0.001     0.016    0.987     -135.591     137.768 
 liver_test     126.675        33.832        0.341     3.744    0.000       58.613     194.737 
enzyme_test       7.523         1.543        0.402     4.874    0.000        4.418      10.628 
  alc_heavy     361.751        87.140        0.357     4.151    0.000      186.448     537.053 
     pindex       7.862         1.908        0.334     4.120    0.000        4.023      11.700 
-----------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_forward_p(model, exclude = c("pindex"))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      liver_test     771.875    777.842    616.009    0.45454    0.44405 
 2      alc_heavy      761.439    769.395    605.506    0.56674    0.54975 
 3      enzyme_test    750.509    760.454    595.297    0.65900    0.63854 
 4      bcs            750.782    762.716    595.377    0.66973    0.64277 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.818       RMSE                 226.248 
R-Squared                 0.670       MSE                56411.635 
Adj. R-Squared            0.643       Coef. Var             33.829 
Pred R-Squared            0.567       AIC                  750.782 
MAE                     171.544       SBC                  762.716 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    5605350.444         4    1401337.611    24.841    0.0000 
Residual      2764170.093        49      56411.635                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                     Parameter Estimates                                       
----------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
----------------------------------------------------------------------------------------------
(Intercept)    -534.711       197.967                 -2.701    0.009    -932.540    -136.882 
 liver_test     149.496        43.277        0.403     3.454    0.001      62.528     236.464 
  alc_heavy     292.382        86.822        0.288     3.368    0.001     117.907     466.858 
enzyme_test       7.431         1.929        0.397     3.851    0.000       3.554      11.309 
        bcs      34.471        27.316        0.139     1.262    0.213     -20.422      89.365 
----------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_p(model, exclude = c(2))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      liver_test     771.875    777.842    616.009    0.45454    0.44405 
 2      alc_heavy      761.439    769.395    605.506    0.56674    0.54975 
 3      enzyme_test    750.509    760.454    595.297    0.65900    0.63854 
 4      bcs            750.782    762.716    595.377    0.66973    0.64277 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.818       RMSE                 226.248 
R-Squared                 0.670       MSE                56411.635 
Adj. R-Squared            0.643       Coef. Var             33.829 
Pred R-Squared            0.567       AIC                  750.782 
MAE                     171.544       SBC                  762.716 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    5605350.444         4    1401337.611    24.841    0.0000 
Residual      2764170.093        49      56411.635                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                     Parameter Estimates                                       
----------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
----------------------------------------------------------------------------------------------
(Intercept)    -534.711       197.967                 -2.701    0.009    -932.540    -136.882 
 liver_test     149.496        43.277        0.403     3.454    0.001      62.528     236.464 
  alc_heavy     292.382        86.822        0.288     3.368    0.001     117.907     466.858 
enzyme_test       7.431         1.929        0.397     3.851    0.000       3.554      11.309 
        bcs      34.471        27.316        0.139     1.262    0.213     -20.422      89.365 
----------------------------------------------------------------------------------------------

> 
> # hierarchical selection
> model <- lm(y ~ bcs + alc_heavy + pindex + enzyme_test, data = surgical)
> ols_step_forward_p(model, 0.1, hierarchical = TRUE)


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.746    0.00000    0.00000 
 1      bcs            797.697    803.664    640.579    0.12010    0.10318 
 2      alc_heavy      791.701    799.657    633.556    0.24119    0.21144 
 3      pindex         778.574    788.519    620.215    0.42659    0.39218 
 4      enzyme_test    730.924    742.858    578.678    0.77136    0.75269 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
------------------------------------------------------------------------------------------------

> 
> # plot
> k <- ols_step_forward_p(model, 0.1, hierarchical = TRUE)
> plot(k)
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_forward_r2")
> ### * ols_step_forward_r2
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_forward_r2
> ### Title: Stepwise R-Squared forward regression
> ### Aliases: ols_step_forward_r2 ols_step_forward_r2.default
> ###   plot.ols_step_forward_r2
> 
> ### ** Examples
> 
> # stepwise forward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_forward_r2(model)


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      liver_test     771.875    777.842    616.009    0.45454    0.44405 
 2      alc_heavy      761.439    769.395    605.506    0.56674    0.54975 
 3      enzyme_test    750.509    760.454    595.297    0.65900    0.63854 
 4      pindex         735.715    747.649    582.943    0.75015    0.72975 
 5      bcs            730.620    744.543    579.638    0.78091    0.75808 
 6      age            732.494    748.406    581.938    0.78142    0.75351 
 7      gender         734.407    752.308    584.276    0.78177    0.74856 
 8      alc_mod        736.390    756.280    586.665    0.78184    0.74305 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 183.883 
R-Squared                 0.782       MSE                40575.683 
Adj. R-Squared            0.743       Coef. Var             28.691 
Pred R-Squared            0.668       AIC                  736.390 
MAE                     137.058       SBC                  756.280 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6543614.824         8     817951.853    20.159    0.0000 
Residual      1825905.713        45      40575.683                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1148.823       242.328                 -4.741    0.000    -1636.896    -660.750 
 liver_test       50.413        44.959        0.136     1.121    0.268      -40.140     140.965 
  alc_heavy      320.697        85.070        0.316     3.770    0.000      149.357     492.037 
enzyme_test        9.888         1.742        0.529     5.677    0.000        6.380      13.396 
     pindex        8.973         1.874        0.382     4.788    0.000        5.199      12.748 
        bcs       62.390        24.470        0.252     2.550    0.014       13.106     111.675 
        age       -0.951         2.649       -0.027    -0.359    0.721       -6.286       4.384 
     gender       15.874        58.475        0.020     0.271    0.787     -101.900     133.648 
    alc_mod        7.713        64.956        0.010     0.119    0.906     -123.116     138.542 
------------------------------------------------------------------------------------------------

> 
> # stepwise forward regression plot
> k <- ols_step_forward_r2(model)
> plot(k)
> 
> # selection metrics
> k$metrics
  step    variable        r2    adj_r2      aic      sbc     sbic
1    1  liver_test 0.4545389 0.4440492 771.8753 777.8423 616.0089
2    2   alc_heavy 0.5667409 0.5497504 761.4394 769.3953 605.5062
3    3 enzyme_test 0.6590000 0.6385400 750.5089 760.4538 595.2974
4    4      pindex 0.7501457 0.7297495 735.7146 747.6485 582.9426
5    5         bcs 0.7809054 0.7580831 730.6204 744.5433 579.6377
6    6         age 0.7814169 0.7535127 732.4942 748.4061 581.9383
7    7      gender 0.7817703 0.7485615 734.4068 752.3077 584.2757
8    8     alc_mod 0.7818387 0.7430544 736.3899 756.2797 586.6645
> 
> # extract final model
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)   liver_test    alc_heavy  enzyme_test       pindex          bcs  
  -1148.823       50.413      320.697        9.888        8.973       62.390  
        age       gender      alc_mod  
     -0.951       15.874        7.713  

> 
> # include or exclude variables
> # force variable to be included in selection process
> ols_step_forward_r2(model, include = c("age"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      liver_test     773.831    781.787    616.928    0.45498     0.43361 
 2      alc_heavy      763.110    773.055    606.421    0.56938     0.54354 
 3      enzyme_test    752.416    764.350    596.755    0.65959     0.63180 
 4      pindex         737.680    751.603    585.012    0.75030     0.72429 
 5      bcs            732.494    748.406    581.938    0.78142     0.75351 
 6      gender         734.407    752.308    584.276    0.78177     0.74856 
 7      alc_mod        736.390    756.280    586.665    0.78184     0.74305 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 183.883 
R-Squared                 0.782       MSE                40575.683 
Adj. R-Squared            0.743       Coef. Var             28.691 
Pred R-Squared            0.668       AIC                  736.390 
MAE                     137.058       SBC                  756.280 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6543614.824         8     817951.853    20.159    0.0000 
Residual      1825905.713        45      40575.683                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1148.823       242.328                 -4.741    0.000    -1636.896    -660.750 
        age       -0.951         2.649       -0.027    -0.359    0.721       -6.286       4.384 
 liver_test       50.413        44.959        0.136     1.121    0.268      -40.140     140.965 
  alc_heavy      320.697        85.070        0.316     3.770    0.000      149.357     492.037 
enzyme_test        9.888         1.742        0.529     5.677    0.000        6.380      13.396 
     pindex        8.973         1.874        0.382     4.788    0.000        5.199      12.748 
        bcs       62.390        24.470        0.252     2.550    0.014       13.106     111.675 
     gender       15.874        58.475        0.020     0.271    0.787     -101.900     133.648 
    alc_mod        7.713        64.956        0.010     0.119    0.906     -123.116     138.542 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_r2(model, include = c(5))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      liver_test     773.831    781.787    616.928    0.45498     0.43361 
 2      alc_heavy      763.110    773.055    606.421    0.56938     0.54354 
 3      enzyme_test    752.416    764.350    596.755    0.65959     0.63180 
 4      pindex         737.680    751.603    585.012    0.75030     0.72429 
 5      bcs            732.494    748.406    581.938    0.78142     0.75351 
 6      gender         734.407    752.308    584.276    0.78177     0.74856 
 7      alc_mod        736.390    756.280    586.665    0.78184     0.74305 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 183.883 
R-Squared                 0.782       MSE                40575.683 
Adj. R-Squared            0.743       Coef. Var             28.691 
Pred R-Squared            0.668       AIC                  736.390 
MAE                     137.058       SBC                  756.280 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6543614.824         8     817951.853    20.159    0.0000 
Residual      1825905.713        45      40575.683                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1148.823       242.328                 -4.741    0.000    -1636.896    -660.750 
        age       -0.951         2.649       -0.027    -0.359    0.721       -6.286       4.384 
 liver_test       50.413        44.959        0.136     1.121    0.268      -40.140     140.965 
  alc_heavy      320.697        85.070        0.316     3.770    0.000      149.357     492.037 
enzyme_test        9.888         1.742        0.529     5.677    0.000        6.380      13.396 
     pindex        8.973         1.874        0.382     4.788    0.000        5.199      12.748 
        bcs       62.390        24.470        0.252     2.550    0.014       13.106     111.675 
     gender       15.874        58.475        0.020     0.271    0.787     -101.900     133.648 
    alc_mod        7.713        64.956        0.010     0.119    0.906     -123.116     138.542 
------------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_forward_r2(model, exclude = c("liver_test"))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      enzyme_test    782.629    788.596    626.220    0.33435    0.32154 
 2      bcs            766.271    774.226    609.940    0.52619    0.50761 
 3      pindex         746.376    756.320    591.702    0.68413    0.66518 
 4      alc_heavy      730.924    742.858    579.087    0.77136    0.75269 
 5      age            732.339    746.262    580.934    0.77382    0.75026 
 6      gender         733.921    749.833    582.951    0.77556    0.74691 
 7      alc_mod        735.878    753.779    585.255    0.77574    0.74162 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.881       RMSE                 186.434 
R-Squared                 0.776       MSE                40802.649 
Adj. R-Squared            0.742       Coef. Var             28.771 
Pred R-Squared            0.666       AIC                  735.878 
MAE                     138.247       SBC                  753.779 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6492598.668         7     927514.095    22.732    0.0000 
Residual      1876921.869        46      40802.649                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1235.188       230.403                 -5.361    0.000    -1698.966    -771.410 
enzyme_test       11.120         1.355        0.595     8.205    0.000        8.392      13.848 
        bcs       80.761        18.226        0.326     4.431    0.000       44.073     117.449 
     pindex        9.914         1.680        0.422     5.900    0.000        6.531      13.297 
  alc_heavy      318.305        85.281        0.314     3.732    0.001      146.643     489.966 
        age       -1.850         2.531       -0.052    -0.731    0.469       -6.946       3.245 
     gender       33.699        56.430        0.043     0.597    0.553      -79.888     147.286 
    alc_mod       12.493        64.997        0.016     0.192    0.848     -118.340     143.326 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_r2(model, exclude = c(4))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      enzyme_test    782.629    788.596    626.220    0.33435    0.32154 
 2      bcs            766.271    774.226    609.940    0.52619    0.50761 
 3      pindex         746.376    756.320    591.702    0.68413    0.66518 
 4      alc_heavy      730.924    742.858    579.087    0.77136    0.75269 
 5      age            732.339    746.262    580.934    0.77382    0.75026 
 6      gender         733.921    749.833    582.951    0.77556    0.74691 
 7      alc_mod        735.878    753.779    585.255    0.77574    0.74162 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.881       RMSE                 186.434 
R-Squared                 0.776       MSE                40802.649 
Adj. R-Squared            0.742       Coef. Var             28.771 
Pred R-Squared            0.666       AIC                  735.878 
MAE                     138.247       SBC                  753.779 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6492598.668         7     927514.095    22.732    0.0000 
Residual      1876921.869        46      40802.649                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1235.188       230.403                 -5.361    0.000    -1698.966    -771.410 
enzyme_test       11.120         1.355        0.595     8.205    0.000        8.392      13.848 
        bcs       80.761        18.226        0.326     4.431    0.000       44.073     117.449 
     pindex        9.914         1.680        0.422     5.900    0.000        6.531      13.297 
  alc_heavy      318.305        85.281        0.314     3.732    0.001      146.643     489.966 
        age       -1.850         2.531       -0.052    -0.731    0.469       -6.946       3.245 
     gender       33.699        56.430        0.043     0.597    0.553      -79.888     147.286 
    alc_mod       12.493        64.997        0.016     0.192    0.848     -118.340     143.326 
------------------------------------------------------------------------------------------------

> 
> # include & exclude variables in the selection process
> ols_step_forward_r2(model, include = c("age"), exclude = c("liver_test"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      enzyme_test    783.607    791.563    626.048    0.34683     0.32121 
 2      bcs            767.078    777.023    609.973    0.53654     0.50873 
 3      pindex         747.171    759.105    592.354    0.69109     0.66588 
 4      alc_heavy      732.339    746.262    580.934    0.77382     0.75026 
 5      gender         733.921    749.833    582.951    0.77556     0.74691 
 6      alc_mod        735.878    753.779    585.255    0.77574     0.74162 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.881       RMSE                 186.434 
R-Squared                 0.776       MSE                40802.649 
Adj. R-Squared            0.742       Coef. Var             28.771 
Pred R-Squared            0.666       AIC                  735.878 
MAE                     138.247       SBC                  753.779 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6492598.668         7     927514.095    22.732    0.0000 
Residual      1876921.869        46      40802.649                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1235.188       230.403                 -5.361    0.000    -1698.966    -771.410 
        age       -1.850         2.531       -0.052    -0.731    0.469       -6.946       3.245 
enzyme_test       11.120         1.355        0.595     8.205    0.000        8.392      13.848 
        bcs       80.761        18.226        0.326     4.431    0.000       44.073     117.449 
     pindex        9.914         1.680        0.422     5.900    0.000        6.531      13.297 
  alc_heavy      318.305        85.281        0.314     3.732    0.001      146.643     489.966 
     gender       33.699        56.430        0.043     0.597    0.553      -79.888     147.286 
    alc_mod       12.493        64.997        0.016     0.192    0.848     -118.340     143.326 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_r2(model, include = c(5), exclude = c(4))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      enzyme_test    783.607    791.563    626.048    0.34683     0.32121 
 2      bcs            767.078    777.023    609.973    0.53654     0.50873 
 3      pindex         747.171    759.105    592.354    0.69109     0.66588 
 4      alc_heavy      732.339    746.262    580.934    0.77382     0.75026 
 5      gender         733.921    749.833    582.951    0.77556     0.74691 
 6      alc_mod        735.878    753.779    585.255    0.77574     0.74162 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.881       RMSE                 186.434 
R-Squared                 0.776       MSE                40802.649 
Adj. R-Squared            0.742       Coef. Var             28.771 
Pred R-Squared            0.666       AIC                  735.878 
MAE                     138.247       SBC                  753.779 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6492598.668         7     927514.095    22.732    0.0000 
Residual      1876921.869        46      40802.649                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1235.188       230.403                 -5.361    0.000    -1698.966    -771.410 
        age       -1.850         2.531       -0.052    -0.731    0.469       -6.946       3.245 
enzyme_test       11.120         1.355        0.595     8.205    0.000        8.392      13.848 
        bcs       80.761        18.226        0.326     4.431    0.000       44.073     117.449 
     pindex        9.914         1.680        0.422     5.900    0.000        6.531      13.297 
  alc_heavy      318.305        85.281        0.314     3.732    0.001      146.643     489.966 
     gender       33.699        56.430        0.043     0.597    0.553      -79.888     147.286 
    alc_mod       12.493        64.997        0.016     0.192    0.848     -118.340     143.326 
------------------------------------------------------------------------------------------------

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_forward_sbc")
> ### * ols_step_forward_sbc
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_forward_sbc
> ### Title: Stepwise SBC forward regression
> ### Aliases: ols_step_forward_sbc ols_step_forward_sbc.default
> ###   plot.ols_step_forward_sbc
> 
> ### ** Examples
> 
> # stepwise forward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_forward_sbc(model)


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      liver_test     771.875    777.842    616.009    0.45454    0.44405 
 2      alc_heavy      761.439    769.395    605.506    0.56674    0.54975 
 3      enzyme_test    750.509    760.454    595.297    0.65900    0.63854 
 4      pindex         735.715    747.649    582.943    0.75015    0.72975 
 5      bcs            730.620    744.543    579.638    0.78091    0.75808 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.276 
R-Squared                 0.781       MSE                38202.426 
Adj. R-Squared            0.758       Coef. Var             27.839 
Pred R-Squared            0.700       AIC                  730.620 
MAE                     137.656       SBC                  744.543 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------

> 
> # stepwise forward regression plot
> k <- ols_step_forward_sbc(model)
> plot(k)
> 
> # selection metrics
> k$metrics
  step    variable        r2    adj_r2      aic      sbc     sbic
1    1  liver_test 0.4545389 0.4440492 771.8753 777.8423 616.0089
2    2   alc_heavy 0.5667409 0.5497504 761.4394 769.3953 605.5062
3    3 enzyme_test 0.6590000 0.6385400 750.5089 760.4538 595.2974
4    4      pindex 0.7501457 0.7297495 735.7146 747.6485 582.9426
5    5         bcs 0.7809054 0.7580831 730.6204 744.5433 579.6377
> 
> # extract final model
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)   liver_test    alc_heavy  enzyme_test       pindex          bcs  
  -1178.330       58.064      317.848        9.748        8.924       59.864  

> 
> # include or exclude variables
> # force variable to be included in selection process
> ols_step_forward_sbc(model, include = c("age"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      liver_test     773.831    781.787    616.928    0.45498     0.43361 
 2      alc_heavy      763.110    773.055    606.421    0.56938     0.54354 
 3      enzyme_test    752.416    764.350    596.755    0.65959     0.63180 
 4      pindex         737.680    751.603    585.012    0.75030     0.72429 
 5      bcs            732.494    748.406    581.938    0.78142     0.75351 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.061 
R-Squared                 0.781       MSE                38924.162 
Adj. R-Squared            0.754       Coef. Var             28.101 
Pred R-Squared            0.692       AIC                  732.494 
MAE                     138.160       SBC                  748.406 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6540084.920         6    1090014.153    28.004    0.0000 
Residual      1829435.617        47      38924.162                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1143.080       235.943                 -4.845    0.000    -1617.737    -668.424 
        age       -0.850         2.563       -0.024    -0.332    0.742       -6.007       4.307 
 liver_test       54.053        42.288        0.146     1.278    0.207      -31.019     139.125 
  alc_heavy      314.585        72.974        0.310     4.311    0.000      167.781     461.390 
enzyme_test        9.852         1.700        0.527     5.794    0.000        6.431      13.273 
     pindex        8.974         1.832        0.382     4.900    0.000        5.290      12.659 
        bcs       61.424        23.748        0.248     2.586    0.013       13.649     109.199 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_sbc(model, include = c(5))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      liver_test     773.831    781.787    616.928    0.45498     0.43361 
 2      alc_heavy      763.110    773.055    606.421    0.56938     0.54354 
 3      enzyme_test    752.416    764.350    596.755    0.65959     0.63180 
 4      pindex         737.680    751.603    585.012    0.75030     0.72429 
 5      bcs            732.494    748.406    581.938    0.78142     0.75351 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.061 
R-Squared                 0.781       MSE                38924.162 
Adj. R-Squared            0.754       Coef. Var             28.101 
Pred R-Squared            0.692       AIC                  732.494 
MAE                     138.160       SBC                  748.406 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6540084.920         6    1090014.153    28.004    0.0000 
Residual      1829435.617        47      38924.162                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1143.080       235.943                 -4.845    0.000    -1617.737    -668.424 
        age       -0.850         2.563       -0.024    -0.332    0.742       -6.007       4.307 
 liver_test       54.053        42.288        0.146     1.278    0.207      -31.019     139.125 
  alc_heavy      314.585        72.974        0.310     4.311    0.000      167.781     461.390 
enzyme_test        9.852         1.700        0.527     5.794    0.000        6.431      13.273 
     pindex        8.974         1.832        0.382     4.900    0.000        5.290      12.659 
        bcs       61.424        23.748        0.248     2.586    0.013       13.649     109.199 
------------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_forward_sbc(model, exclude = c("liver_test"))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      enzyme_test    782.629    788.596    626.220    0.33435    0.32154 
 2      bcs            766.271    774.226    609.940    0.52619    0.50761 
 3      pindex         746.376    756.320    591.702    0.68413    0.66518 
 4      alc_heavy      730.924    742.858    579.087    0.77136    0.75269 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_sbc(model, exclude = c(4))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      enzyme_test    782.629    788.596    626.220    0.33435    0.32154 
 2      bcs            766.271    774.226    609.940    0.52619    0.50761 
 3      pindex         746.376    756.320    591.702    0.68413    0.66518 
 4      alc_heavy      730.924    742.858    579.087    0.77136    0.75269 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
------------------------------------------------------------------------------------------------

> 
> # include & exclude variables in the selection process
> ols_step_forward_sbc(model, include = c("age"), exclude = c("liver_test"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      enzyme_test    783.607    791.563    626.048    0.34683     0.32121 
 2      bcs            767.078    777.023    609.973    0.53654     0.50873 
 3      pindex         747.171    759.105    592.354    0.69109     0.66588 
 4      alc_heavy      732.339    746.262    580.934    0.77382     0.75026 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.880       RMSE                 187.233 
R-Squared                 0.774       MSE                39438.163 
Adj. R-Squared            0.750       Coef. Var             28.286 
Pred R-Squared            0.688       AIC                  732.339 
MAE                     140.528       SBC                  746.262 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6476488.730         5    1295297.746    32.844    0.0000 
Residual      1893031.807        48      39438.163                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1237.653       225.517                 -5.488    0.000    -1691.085    -784.221 
        age       -1.787         2.473       -0.050    -0.723    0.473       -6.759       3.184 
enzyme_test       11.244         1.314        0.601     8.555    0.000        8.601      13.887 
        bcs       81.587        17.870        0.329     4.566    0.000       45.657     117.516 
     pindex       10.062         1.633        0.428     6.163    0.000        6.779      13.344 
  alc_heavy      306.655        73.188        0.303     4.190    0.000      159.500     453.809 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_sbc(model, include = c(5), exclude = c(4))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      enzyme_test    783.607    791.563    626.048    0.34683     0.32121 
 2      bcs            767.078    777.023    609.973    0.53654     0.50873 
 3      pindex         747.171    759.105    592.354    0.69109     0.66588 
 4      alc_heavy      732.339    746.262    580.934    0.77382     0.75026 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.880       RMSE                 187.233 
R-Squared                 0.774       MSE                39438.163 
Adj. R-Squared            0.750       Coef. Var             28.286 
Pred R-Squared            0.688       AIC                  732.339 
MAE                     140.528       SBC                  746.262 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6476488.730         5    1295297.746    32.844    0.0000 
Residual      1893031.807        48      39438.163                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1237.653       225.517                 -5.488    0.000    -1691.085    -784.221 
        age       -1.787         2.473       -0.050    -0.723    0.473       -6.759       3.184 
enzyme_test       11.244         1.314        0.601     8.555    0.000        8.601      13.887 
        bcs       81.587        17.870        0.329     4.566    0.000       45.657     117.516 
     pindex       10.062         1.633        0.428     6.163    0.000        6.779      13.344 
  alc_heavy      306.655        73.188        0.303     4.190    0.000      159.500     453.809 
------------------------------------------------------------------------------------------------

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_step_forward_sbic")
> ### * ols_step_forward_sbic
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_step_forward_sbic
> ### Title: Stepwise SBIC forward regression
> ### Aliases: ols_step_forward_sbic ols_step_forward_sbic.default
> ###   plot.ols_step_forward_sbic
> 
> ### ** Examples
> 
> # stepwise forward regression
> model <- lm(y ~ ., data = surgical)
> ols_step_forward_sbic(model)


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      liver_test     771.875    777.842    616.009    0.45454    0.44405 
 2      alc_heavy      761.439    769.395    605.506    0.56674    0.54975 
 3      enzyme_test    750.509    760.454    595.297    0.65900    0.63854 
 4      pindex         735.715    747.649    582.943    0.75015    0.72975 
 5      bcs            730.620    744.543    579.638    0.78091    0.75808 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.276 
R-Squared                 0.781       MSE                38202.426 
Adj. R-Squared            0.758       Coef. Var             27.839 
Pred R-Squared            0.700       AIC                  730.620 
MAE                     137.656       SBC                  744.543 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------

> 
> # stepwise forward regression plot
> k <- ols_step_forward_sbic(model)
> plot(k)
> 
> # selection metrics
> k$metrics
  step    variable        r2    adj_r2      aic      sbc     sbic
1    1  liver_test 0.4545389 0.4440492 771.8753 777.8423 616.0089
2    2   alc_heavy 0.5667409 0.5497504 761.4394 769.3953 605.5062
3    3 enzyme_test 0.6590000 0.6385400 750.5089 760.4538 595.2974
4    4      pindex 0.7501457 0.7297495 735.7146 747.6485 582.9426
5    5         bcs 0.7809054 0.7580831 730.6204 744.5433 579.6377
> 
> # extract final model
> k$model

Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)   liver_test    alc_heavy  enzyme_test       pindex          bcs  
  -1178.330       58.064      317.848        9.748        8.924       59.864  

> 
> # include or exclude variables
> # force variable to be included in selection process
> ols_step_forward_sbic(model, include = c("age"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      liver_test     773.831    781.787    616.928    0.45498     0.43361 
 2      alc_heavy      763.110    773.055    606.421    0.56938     0.54354 
 3      enzyme_test    752.416    764.350    596.755    0.65959     0.63180 
 4      pindex         737.680    751.603    585.012    0.75030     0.72429 
 5      bcs            732.494    748.406    581.938    0.78142     0.75351 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.061 
R-Squared                 0.781       MSE                38924.162 
Adj. R-Squared            0.754       Coef. Var             28.101 
Pred R-Squared            0.692       AIC                  732.494 
MAE                     138.160       SBC                  748.406 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6540084.920         6    1090014.153    28.004    0.0000 
Residual      1829435.617        47      38924.162                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1143.080       235.943                 -4.845    0.000    -1617.737    -668.424 
        age       -0.850         2.563       -0.024    -0.332    0.742       -6.007       4.307 
 liver_test       54.053        42.288        0.146     1.278    0.207      -31.019     139.125 
  alc_heavy      314.585        72.974        0.310     4.311    0.000      167.781     461.390 
enzyme_test        9.852         1.700        0.527     5.794    0.000        6.431      13.273 
     pindex        8.974         1.832        0.382     4.900    0.000        5.290      12.659 
        bcs       61.424        23.748        0.248     2.586    0.013       13.649     109.199 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_sbic(model, include = c(5))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      liver_test     773.831    781.787    616.928    0.45498     0.43361 
 2      alc_heavy      763.110    773.055    606.421    0.56938     0.54354 
 3      enzyme_test    752.416    764.350    596.755    0.65959     0.63180 
 4      pindex         737.680    751.603    585.012    0.75030     0.72429 
 5      bcs            732.494    748.406    581.938    0.78142     0.75351 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.884       RMSE                 184.061 
R-Squared                 0.781       MSE                38924.162 
Adj. R-Squared            0.754       Coef. Var             28.101 
Pred R-Squared            0.692       AIC                  732.494 
MAE                     138.160       SBC                  748.406 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6540084.920         6    1090014.153    28.004    0.0000 
Residual      1829435.617        47      38924.162                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1143.080       235.943                 -4.845    0.000    -1617.737    -668.424 
        age       -0.850         2.563       -0.024    -0.332    0.742       -6.007       4.307 
 liver_test       54.053        42.288        0.146     1.278    0.207      -31.019     139.125 
  alc_heavy      314.585        72.974        0.310     4.311    0.000      167.781     461.390 
enzyme_test        9.852         1.700        0.527     5.794    0.000        6.431      13.273 
     pindex        8.974         1.832        0.382     4.900    0.000        5.290      12.659 
        bcs       61.424        23.748        0.248     2.586    0.013       13.649     109.199 
------------------------------------------------------------------------------------------------

> 
> # force variable to be excluded from selection process
> ols_step_forward_sbic(model, exclude = c("liver_test"))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      enzyme_test    782.629    788.596    626.220    0.33435    0.32154 
 2      bcs            766.271    774.226    609.940    0.52619    0.50761 
 3      pindex         746.376    756.320    591.702    0.68413    0.66518 
 4      alc_heavy      730.924    742.858    579.087    0.77136    0.75269 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_sbic(model, exclude = c(4))


                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
 1      enzyme_test    782.629    788.596    626.220    0.33435    0.32154 
 2      bcs            766.271    774.226    609.940    0.52619    0.50761 
 3      pindex         746.376    756.320    591.702    0.68413    0.66518 
 4      alc_heavy      730.924    742.858    579.087    0.77136    0.75269 
--------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.878       RMSE                 188.249 
R-Squared                 0.771       MSE                39053.801 
Adj. R-Squared            0.753       Coef. Var             28.147 
Pred R-Squared            0.695       AIC                  730.924 
MAE                     140.619       SBC                  742.858 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6455884.265         4    1613971.066    41.327    0.0000 
Residual      1913636.272        49      39053.801                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1334.424       180.589                 -7.389    0.000    -1697.332    -971.516 
enzyme_test       11.243         1.308        0.601     8.596    0.000        8.614      13.871 
        bcs       81.439        17.781        0.329     4.580    0.000       45.706     117.171 
     pindex       10.131         1.622        0.431     6.246    0.000        6.871      13.390 
  alc_heavy      312.777        72.341        0.309     4.324    0.000      167.402     458.152 
------------------------------------------------------------------------------------------------

> 
> # include & exclude variables in the selection process
> ols_step_forward_sbic(model, include = c("age"), exclude = c("liver_test"))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      enzyme_test    783.607    791.563    626.048    0.34683     0.32121 
 2      bcs            767.078    777.023    609.973    0.53654     0.50873 
 3      pindex         747.171    759.105    592.354    0.69109     0.66588 
 4      alc_heavy      732.339    746.262    580.934    0.77382     0.75026 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.880       RMSE                 187.233 
R-Squared                 0.774       MSE                39438.163 
Adj. R-Squared            0.750       Coef. Var             28.286 
Pred R-Squared            0.688       AIC                  732.339 
MAE                     140.528       SBC                  746.262 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6476488.730         5    1295297.746    32.844    0.0000 
Residual      1893031.807        48      39438.163                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1237.653       225.517                 -5.488    0.000    -1691.085    -784.221 
        age       -1.787         2.473       -0.050    -0.723    0.473       -6.759       3.184 
enzyme_test       11.244         1.314        0.601     8.555    0.000        8.601      13.887 
        bcs       81.587        17.870        0.329     4.566    0.000       45.657     117.516 
     pindex       10.062         1.633        0.428     6.163    0.000        6.779      13.344 
  alc_heavy      306.655        73.188        0.303     4.190    0.000      159.500     453.809 
------------------------------------------------------------------------------------------------

> 
> # use index of variable instead of name
> ols_step_forward_sbic(model, include = c(5), exclude = c(4))


                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2  
---------------------------------------------------------------------------
 0      Base Model     803.834    809.801    646.572    0.01420    -0.00476 
 1      enzyme_test    783.607    791.563    626.048    0.34683     0.32121 
 2      bcs            767.078    777.023    609.973    0.53654     0.50873 
 3      pindex         747.171    759.105    592.354    0.69109     0.66588 
 4      alc_heavy      732.339    746.262    580.934    0.77382     0.75026 
---------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.880       RMSE                 187.233 
R-Squared                 0.774       MSE                39438.163 
Adj. R-Squared            0.750       Coef. Var             28.286 
Pred R-Squared            0.688       AIC                  732.339 
MAE                     140.528       SBC                  746.262 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6476488.730         5    1295297.746    32.844    0.0000 
Residual      1893031.807        48      39438.163                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1237.653       225.517                 -5.488    0.000    -1691.085    -784.221 
        age       -1.787         2.473       -0.050    -0.723    0.473       -6.759       3.184 
enzyme_test       11.244         1.314        0.601     8.555    0.000        8.601      13.887 
        bcs       81.587        17.870        0.329     4.566    0.000       45.657     117.516 
     pindex       10.062         1.633        0.428     6.163    0.000        6.779      13.344 
  alc_heavy      306.655        73.188        0.303     4.190    0.000      159.500     453.809 
------------------------------------------------------------------------------------------------

> 
> 
> 
> 
> cleanEx()
> nameEx("ols_test_bartlett")
> ### * ols_test_bartlett
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_test_bartlett
> ### Title: Bartlett test
> ### Aliases: ols_test_bartlett ols_test_bartlett.default
> 
> ### ** Examples
> 
> # using grouping variable
> if (require("descriptr")) {
+   library(descriptr)
+   ols_test_bartlett(mtcarz, 'mpg', group_var = 'cyl')
+ }
Loading required package: descriptr

Attaching package: 'descriptr'

The following object is masked from 'package:olsrr':

    hsb


    Bartlett's Test of Homogenity of Variances    
------------------------------------------------
Ho: Variances are equal across groups
Ha: Variances are unequal for atleast two groups

        Test Summary          
 -----------------------------
 DF            =    2 
 Chi2          =    8.39345 
 Prob > Chi2   =    0.01504477 
> 
> # using variables
> ols_test_bartlett(hsb, 'read', 'write')

    Bartlett's Test of Homogenity of Variances    
------------------------------------------------
Ho: Variances are equal across groups
Ha: Variances are unequal for atleast two groups

        Data          
 ---------------------
 Variables: read write 

        Test Summary         
 ----------------------------
 DF            =    1 
 Chi2          =    1.222871 
 Prob > Chi2   =    0.2687979 
> 
> 
> 
> 
> cleanEx()

detaching 'package:descriptr'

> nameEx("ols_test_breusch_pagan")
> ### * ols_test_breusch_pagan
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_test_breusch_pagan
> ### Title: Breusch pagan test
> ### Aliases: ols_test_breusch_pagan
> 
> ### ** Examples
> 
> # model
> model <- lm(mpg ~ disp + hp + wt + drat, data = mtcars)
> 
> # use fitted values of the model
> ols_test_breusch_pagan(model)

 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

             Data               
 -------------------------------
 Response : mpg 
 Variables: fitted values of mpg 

       Test Summary         
 ---------------------------
 DF            =    1 
 Chi2          =    1.429672 
 Prob > Chi2   =    0.231818 
> 
> # use independent variables of the model
> ols_test_breusch_pagan(model, rhs = TRUE)

 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

           Data            
 --------------------------
 Response : mpg 
 Variables: disp hp wt drat 

        Test Summary         
 ----------------------------
 DF            =    4 
 Chi2          =    1.513808 
 Prob > Chi2   =    0.8241927 
> 
> # use independent variables of the model and perform multiple tests
> ols_test_breusch_pagan(model, rhs = TRUE, multiple = TRUE)

 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

           Data            
 --------------------------
 Response : mpg 
 Variables: disp hp wt drat 

        Test Summary (Unadjusted p values)       
 ----------------------------------------------
  Variable           chi2       df        p     
 ----------------------------------------------
  disp             1.2355345     1    0.2663334 
  hp               0.9209878     1    0.3372157 
  wt               1.2529988     1    0.2629805 
  drat             1.1668486     1    0.2800497 
 ----------------------------------------------
  simultaneous     1.5138083     4    0.8241927 
 ----------------------------------------------
> 
> # bonferroni p value adjustment
> ols_test_breusch_pagan(model, rhs = TRUE, multiple = TRUE, p.adj = 'bonferroni')

 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

           Data            
 --------------------------
 Response : mpg 
 Variables: disp hp wt drat 

        Test Summary (Bonferroni p values)       
 ----------------------------------------------
  Variable           chi2       df        p     
 ----------------------------------------------
  disp             1.2355345     1    1.0000000 
  hp               0.9209878     1    1.0000000 
  wt               1.2529988     1    1.0000000 
  drat             1.1668486     1    1.0000000 
 ----------------------------------------------
  simultaneous     1.5138083     4    0.8241927 
 ----------------------------------------------
> 
> # sidak p value adjustment
> ols_test_breusch_pagan(model, rhs = TRUE, multiple = TRUE, p.adj = 'sidak')

 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

           Data            
 --------------------------
 Response : mpg 
 Variables: disp hp wt drat 

          Test Summary (Sidak p values)          
 ----------------------------------------------
  Variable           chi2       df        p     
 ----------------------------------------------
  disp             1.2355345     1    0.7102690 
  hp               0.9209878     1    0.8070305 
  wt               1.2529988     1    0.7049362 
  drat             1.1668486     1    0.7313356 
 ----------------------------------------------
  simultaneous     1.5138083     4    0.8241927 
 ----------------------------------------------
> 
> # holm's p value adjustment
> ols_test_breusch_pagan(model, rhs = TRUE, multiple = TRUE, p.adj = 'holm')

 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

           Data            
 --------------------------
 Response : mpg 
 Variables: disp hp wt drat 

          Test Summary (Holm's p values)         
 ----------------------------------------------
  Variable           chi2       df        p     
 ----------------------------------------------
  disp             1.2355345     1    0.7990002 
  hp               0.9209878     1    0.3372157 
  wt               1.2529988     1    1.0000000 
  drat             1.1668486     1    0.5600994 
 ----------------------------------------------
  simultaneous     1.5138083     4    0.8241927 
 ----------------------------------------------
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_test_correlation")
> ### * ols_test_correlation
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_test_correlation
> ### Title: Correlation test for normality
> ### Aliases: ols_test_correlation
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_test_correlation(model)
[1] 0.970066
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_test_f")
> ### * ols_test_f
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_test_f
> ### Title: F test
> ### Aliases: ols_test_f
> 
> ### ** Examples
> 
> # model
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> 
> # using fitted values
> ols_test_f(model)

 F Test for Heteroskedasticity
 -----------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: fitted values of mpg 

      Test Summary        
 -------------------------
 Num DF     =    1 
 Den DF     =    30 
 F          =    0.4920617 
 Prob > F   =    0.4884154 
> 
> # using all predictors of the model
> ols_test_f(model, rhs = TRUE)

 F Test for Heteroskedasticity
 -----------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: disp hp wt qsec 

      Test Summary        
 -------------------------
 Num DF     =    4 
 Den DF     =    27 
 F          =    0.4594694 
 Prob > F   =    0.7647271 
> 
> # using fitted values
> ols_test_f(model, vars = c('disp', 'hp'))

 F Test for Heteroskedasticity
 -----------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: disp hp 

      Test Summary        
 -------------------------
 Num DF     =    2 
 Den DF     =    29 
 F          =    0.4669306 
 Prob > F   =    0.631555 
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_test_normality")
> ### * ols_test_normality
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_test_normality
> ### Title: Test for normality
> ### Aliases: ols_test_normality ols_test_normality.lm
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
> ols_test_normality(model)
-----------------------------------------------
       Test             Statistic       pvalue  
-----------------------------------------------
Shapiro-Wilk              0.9366         0.0600 
Kolmogorov-Smirnov        0.1152         0.7464 
Cramer-von Mises          2.8122         0.0000 
Anderson-Darling          0.5859         0.1188 
-----------------------------------------------
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_test_outlier")
> ### * ols_test_outlier
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_test_outlier
> ### Title: Bonferroni Outlier Test
> ### Aliases: ols_test_outlier
> 
> ### ** Examples
> 
> # model
> model <- lm(y ~ ., data = surgical)
> ols_test_outlier(model)
  studentized_residual unadjusted_p_val bonferroni_p_val
5             5.713932     8.870345e-07     4.789987e-05
> 
> 
> 
> 
> cleanEx()
> nameEx("ols_test_score")
> ### * ols_test_score
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ols_test_score
> ### Title: Score test
> ### Aliases: ols_test_score
> 
> ### ** Examples
> 
> # model
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> 
> # using fitted values of the model
> ols_test_score(model)

 Score Test for Heteroskedasticity
 ---------------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: fitted values of mpg 

        Test Summary         
 ----------------------------
 DF            =    1 
 Chi2          =    0.6452907 
 Prob > Chi2   =    0.4218014 
> 
> # using predictors from the model
> ols_test_score(model, rhs = TRUE)

 Score Test for Heteroskedasticity
 ---------------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: disp hp wt 

        Test Summary         
 ----------------------------
 DF            =    3 
 Chi2          =    0.945898 
 Prob > Chi2   =    0.8143398 
> 
> # specify predictors from the model
> ols_test_score(model, vars = c('disp', 'wt'))

 Score Test for Heteroskedasticity
 ---------------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: disp wt 

        Test Summary         
 ----------------------------
 DF            =    2 
 Chi2          =    0.5349726 
 Prob > Chi2   =    0.7653008 
> 
> 
> 
> 
> cleanEx()
> nameEx("rvsr_plot_shiny")
> ### * rvsr_plot_shiny
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rvsr_plot_shiny
> ### Title: Residual vs regressors plot for shiny app
> ### Aliases: rvsr_plot_shiny
> 
> ### ** Examples
> 
> model <- lm(mpg ~ disp + hp + wt, data = mtcars)
> rvsr_plot_shiny(model, mtcars, 'drat')
> 
> 
> 
> 
> ### * <FOOTER>
> ###
> cleanEx()
> options(digits = 7L)
> base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  256.08 9.94 294.77 NA NA 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
